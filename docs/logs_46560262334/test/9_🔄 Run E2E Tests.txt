2025-09-30T00:59:25.2214238Z ##[group]Run pytest tests/e2e/ -v --tb=short
2025-09-30T00:59:25.2214832Z [36;1mpytest tests/e2e/ -v --tb=short[0m
2025-09-30T00:59:25.2260918Z shell: /usr/bin/bash -e {0}
2025-09-30T00:59:25.2261315Z env:
2025-09-30T00:59:25.2262143Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T00:59:25.2262588Z   CI: true
2025-09-30T00:59:25.2263098Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T00:59:25.2263532Z   ALGORITHM: HS256
2025-09-30T00:59:25.2263884Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T00:59:25.2264302Z   APP_NAME: The Gathering Test
2025-09-30T00:59:25.2264678Z   DEBUG: false
2025-09-30T00:59:25.2265013Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T00:59:25.2265553Z   pythonLocation: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T00:59:25.2266251Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib/pkgconfig
2025-09-30T00:59:25.2266930Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T00:59:25.2267540Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T00:59:25.2268188Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T00:59:25.2268848Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib
2025-09-30T00:59:25.2269389Z ##[endgroup]
2025-09-30T00:59:26.2474863Z ============================= test session starts ==============================
2025-09-30T00:59:26.2478041Z platform linux -- Python 3.13.7, pytest-8.4.1, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.13.7/x64/bin/python
2025-09-30T00:59:26.2480201Z cachedir: .pytest_cache
2025-09-30T00:59:26.2480785Z rootdir: /home/runner/work/the_gathering_beta/the_gathering_beta
2025-09-30T00:59:26.2481403Z configfile: pytest.ini
2025-09-30T00:59:26.2481849Z plugins: anyio-4.11.0, asyncio-0.25.1, cov-6.2.1
2025-09-30T00:59:26.2482513Z asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None
2025-09-30T00:59:26.3069623Z collecting ... collected 18 items
2025-09-30T00:59:26.3071878Z 
2025-09-30T00:59:27.6724431Z tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_complete_chat_workflow PASSED [  5%]
2025-09-30T00:59:27.9880009Z tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_room_closure_workflow ERROR [ 11%]
2025-09-30T00:59:29.3838690Z tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_authentication_security PASSED [ 16%]
2025-09-30T00:59:29.6316204Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_message_xor_constraint ERROR [ 22%]
2025-09-30T00:59:30.5298252Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_unique_constraints PASSED [ 27%]
2025-09-30T00:59:30.7570681Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_foreign_key_constraints ERROR [ 33%]
2025-09-30T00:59:31.1202349Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_conversation_participant_constraints PASSED [ 38%]
2025-09-30T00:59:31.3507865Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_enum_validation ERROR [ 44%]
2025-09-30T00:59:31.9833585Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_nullable_constraints PASSED [ 50%]
2025-09-30T00:59:32.2124796Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_cascading_deletes ERROR [ 55%]
2025-09-30T00:59:32.2872530Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_database_indexes_exist PASSED [ 61%]
2025-09-30T00:59:32.5205572Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_health_check_endpoint ERROR [ 66%]
2025-09-30T00:59:32.6126309Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_room_count_endpoint PASSED [ 72%]
2025-09-30T00:59:32.8496673Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_all_rooms_endpoint ERROR [ 77%]
2025-09-30T00:59:32.9416951Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_room_by_id_endpoint PASSED [ 83%]
2025-09-30T00:59:33.1765737Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_join_room_workflow ERROR [ 88%]
2025-09-30T00:59:33.2969506Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_send_and_get_messages_workflow PASSED [ 94%]
2025-09-30T00:59:33.5344887Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_leave_room_workflow ERROR [100%]
2025-09-30T00:59:33.5348086Z 
2025-09-30T00:59:33.5348308Z ==================================== ERRORS ====================================
2025-09-30T00:59:33.5349073Z ____ ERROR at setup of TestCriticalUserJourneys.test_room_closure_workflow _____
2025-09-30T00:59:33.5350300Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5351383Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5351922Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5352774Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5358783Z     return future.result()
2025-09-30T00:59:33.5359178Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5359950Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5360908Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5361426Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5361890Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5362408Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5363011Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5363591Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5364223Z     return await anext(self.gen)
2025-09-30T00:59:33.5364553Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5365280Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5366049Z     async with conn:
2025-09-30T00:59:33.5366367Z                ^^^^
2025-09-30T00:59:33.5367370Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5368347Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5368819Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5369718Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5370687Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5371743Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5372765Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5382643Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5388393Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5393291Z     return self._connection_cls(self)
2025-09-30T00:59:33.5393706Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5394440Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5395242Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5395661Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5396424Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5397199Z     return self.pool.connect()
2025-09-30T00:59:33.5397526Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5398193Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5398942Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5399323Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5400338Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5401277Z     with util.safe_reraise():
2025-09-30T00:59:33.5401584Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5402263Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5403241Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5403975Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5404720Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5405521Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5406326Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5406686Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5407508Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5408392Z     dbapi_connection.ping()
2025-09-30T00:59:33.5409136Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5409977Z     self._handle_exception(error)
2025-09-30T00:59:33.5410829Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5411706Z     raise error
2025-09-30T00:59:33.5412423Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5414110Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5414483Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5415271Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5416354Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5417008Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5417817Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5418644Z     value = await result
2025-09-30T00:59:33.5418946Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5419724Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5420551Z     await tr.start()
2025-09-30T00:59:33.5421160Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5421886Z     await self._connection.execute(query)
2025-09-30T00:59:33.5422589Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5423500Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5423928Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5424485Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5424906Z     ???
2025-09-30T00:59:33.5427341Z E   RuntimeError: Task <Task pending name='Task-18' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5429872Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5431098Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2fffcb90>>
2025-09-30T00:59:33.5432419Z Traceback (most recent call last):
2025-09-30T00:59:33.5440526Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5441508Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5441914Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5443227Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5444206Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5444549Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5445480Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5446535Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5447039Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5447949Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5449084Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5449721Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5450653Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5451537Z     value = await result
2025-09-30T00:59:33.5451822Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5452531Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5453472Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5453961Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5454848Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5456124Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5457249Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5457819Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5458582Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5459283Z     self._check_closed()
2025-09-30T00:59:33.5459559Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5460230Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5485638Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.5493972Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.5494563Z ____ ERROR at setup of TestDatabaseConstraints.test_message_xor_constraint _____
2025-09-30T00:59:33.5495570Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5496489Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5496916Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5497598Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5498281Z     return future.result()
2025-09-30T00:59:33.5498588Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5499212Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5499995Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5500442Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5501032Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5501443Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5501973Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5502517Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5503433Z     return await anext(self.gen)
2025-09-30T00:59:33.5503767Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5504464Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5505206Z     async with conn:
2025-09-30T00:59:33.5505478Z                ^^^^
2025-09-30T00:59:33.5506128Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5506908Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5507294Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5508078Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5508884Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5509725Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5510567Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5510934Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5511619Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5512335Z     return self._connection_cls(self)
2025-09-30T00:59:33.5512683Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5513534Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5514301Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5514732Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5515495Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5516272Z     return self.pool.connect()
2025-09-30T00:59:33.5516591Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5517224Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5517972Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5518331Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5519021Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5519749Z     with util.safe_reraise():
2025-09-30T00:59:33.5520060Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5520775Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5521551Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5522263Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5523262Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5524063Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5524869Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5525231Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5526018Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5526820Z     dbapi_connection.ping()
2025-09-30T00:59:33.5527557Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5528345Z     self._handle_exception(error)
2025-09-30T00:59:33.5529389Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5530471Z     raise error
2025-09-30T00:59:33.5531161Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5531969Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5532314Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5533244Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5534322Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5534949Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5535743Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5536569Z     value = await result
2025-09-30T00:59:33.5536859Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5537613Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5538452Z     await tr.start()
2025-09-30T00:59:33.5539062Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5539769Z     await self._connection.execute(query)
2025-09-30T00:59:33.5540470Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5541189Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5541603Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5541992Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5542348Z     ???
2025-09-30T00:59:33.5544657Z E   RuntimeError: Task <Task pending name='Task-28' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5547067Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5548239Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e5bc410>>
2025-09-30T00:59:33.5549333Z Traceback (most recent call last):
2025-09-30T00:59:33.5550298Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5551166Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5551526Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5552479Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5553565Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5553898Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5554804Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5555816Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5556320Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5557264Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5558380Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5559033Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5560111Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5561123Z     value = await result
2025-09-30T00:59:33.5561420Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5562128Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5563038Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5563532Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5564375Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5565608Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5566605Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5567163Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5567936Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5568622Z     self._check_closed()
2025-09-30T00:59:33.5568920Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5569596Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5570872Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.5571980Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.5572543Z ____ ERROR at setup of TestDatabaseConstraints.test_foreign_key_constraints ____
2025-09-30T00:59:33.5573708Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5574604Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5575045Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5575738Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5576451Z     return future.result()
2025-09-30T00:59:33.5576762Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5577420Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5578221Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5578689Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5579078Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5579506Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5579879Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5580605Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5581218Z     return await anext(self.gen)
2025-09-30T00:59:33.5581544Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5582265Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5583177Z     async with conn:
2025-09-30T00:59:33.5583471Z                ^^^^
2025-09-30T00:59:33.5584142Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5584945Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5585347Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5586092Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5586908Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5587783Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5588633Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5589182Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5589900Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5590801Z     return self._connection_cls(self)
2025-09-30T00:59:33.5591166Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5591879Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5592658Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5593235Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5593995Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5594776Z     return self.pool.connect()
2025-09-30T00:59:33.5595106Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5595769Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5596510Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5596895Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5597593Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5598333Z     with util.safe_reraise():
2025-09-30T00:59:33.5598662Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5599367Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5600174Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5600905Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5601649Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5602461Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5603449Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5603819Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5604665Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5605525Z     dbapi_connection.ping()
2025-09-30T00:59:33.5606300Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5607120Z     self._handle_exception(error)
2025-09-30T00:59:33.5608032Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5608891Z     raise error
2025-09-30T00:59:33.5609608Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5610424Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5610794Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5611600Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5612707Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5613517Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5614359Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5615170Z     value = await result
2025-09-30T00:59:33.5615464Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5616248Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5617120Z     await tr.start()
2025-09-30T00:59:33.5617760Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5618676Z     await self._connection.execute(query)
2025-09-30T00:59:33.5619394Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5620325Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5620748Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5621172Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5621547Z     ???
2025-09-30T00:59:33.5623872Z E   RuntimeError: Task <Task pending name='Task-38' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5626320Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5627548Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e5ccc80>>
2025-09-30T00:59:33.5628668Z Traceback (most recent call last):
2025-09-30T00:59:33.5629558Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5630415Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5630782Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5631724Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5632660Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5633208Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5634106Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5635129Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5635642Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5636584Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5637772Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5638434Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5639364Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5640256Z     value = await result
2025-09-30T00:59:33.5640554Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5641273Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5642100Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5642605Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5643631Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5644876Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5645910Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5646464Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5647230Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5647938Z     self._check_closed()
2025-09-30T00:59:33.5648240Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5648910Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5650218Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.5651449Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.5651975Z ________ ERROR at setup of TestDatabaseConstraints.test_enum_validation ________
2025-09-30T00:59:33.5653154Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5654072Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5654505Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5655203Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5655904Z     return future.result()
2025-09-30T00:59:33.5656207Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5656857Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5657657Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5658113Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5658510Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5658926Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5659299Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5659867Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5660469Z     return await anext(self.gen)
2025-09-30T00:59:33.5660811Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5661517Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5662288Z     async with conn:
2025-09-30T00:59:33.5662569Z                ^^^^
2025-09-30T00:59:33.5663382Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5664196Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5664598Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5665349Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5666165Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5667048Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5667897Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5668278Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5668991Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5669737Z     return self._connection_cls(self)
2025-09-30T00:59:33.5670098Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5670792Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5671576Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5672019Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5672919Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5673704Z     return self.pool.connect()
2025-09-30T00:59:33.5674034Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5674693Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5675442Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5675824Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5676519Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5677254Z     with util.safe_reraise():
2025-09-30T00:59:33.5677577Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5678468Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5679407Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5680128Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5680871Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5681691Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5682513Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5683035Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5683863Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5684699Z     dbapi_connection.ping()
2025-09-30T00:59:33.5685475Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5686286Z     self._handle_exception(error)
2025-09-30T00:59:33.5687165Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5688043Z     raise error
2025-09-30T00:59:33.5688759Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5689575Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5689931Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5690721Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5691817Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5692467Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5693411Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5694246Z     value = await result
2025-09-30T00:59:33.5694544Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5695278Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5696085Z     await tr.start()
2025-09-30T00:59:33.5696709Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5697443Z     await self._connection.execute(query)
2025-09-30T00:59:33.5698144Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5698892Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5699319Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5699722Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5700088Z     ???
2025-09-30T00:59:33.5702287Z E   RuntimeError: Task <Task pending name='Task-48' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5704874Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5706058Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e5ccd70>>
2025-09-30T00:59:33.5707164Z Traceback (most recent call last):
2025-09-30T00:59:33.5708124Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5709170Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5709548Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5710697Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5711652Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5711996Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5713054Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5714087Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5714601Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5715521Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5716689Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5717334Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5718713Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5719646Z     value = await result
2025-09-30T00:59:33.5719952Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5720658Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5721444Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5721944Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5722932Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5724197Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5725230Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5725800Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5726585Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5727300Z     self._check_closed()
2025-09-30T00:59:33.5727589Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5728278Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5729463Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.5730541Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.5731074Z _______ ERROR at setup of TestDatabaseConstraints.test_cascading_deletes _______
2025-09-30T00:59:33.5732071Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5733130Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5733567Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5734252Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5734944Z     return future.result()
2025-09-30T00:59:33.5735256Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5735896Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5736674Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5737130Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5737509Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5737935Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5738297Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5738843Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5739664Z     return await anext(self.gen)
2025-09-30T00:59:33.5740140Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5740854Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5741609Z     async with conn:
2025-09-30T00:59:33.5741884Z                ^^^^
2025-09-30T00:59:33.5742565Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5743526Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5743935Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5744684Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5745498Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5746382Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5747258Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5747653Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5748412Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5749190Z     return self._connection_cls(self)
2025-09-30T00:59:33.5749556Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5750247Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5751036Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5751471Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5752219Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5753176Z     return self.pool.connect()
2025-09-30T00:59:33.5753535Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5754204Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5754957Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5755338Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5756060Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5756829Z     with util.safe_reraise():
2025-09-30T00:59:33.5757160Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5757878Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5758641Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5759355Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5760109Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5760928Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5761779Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5762156Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5763109Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5763947Z     dbapi_connection.ping()
2025-09-30T00:59:33.5764720Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5765534Z     self._handle_exception(error)
2025-09-30T00:59:33.5766389Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5767256Z     raise error
2025-09-30T00:59:33.5767964Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5768977Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5769499Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5770288Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5771388Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5772047Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5773002Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5773855Z     value = await result
2025-09-30T00:59:33.5774159Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5774949Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5775820Z     await tr.start()
2025-09-30T00:59:33.5776457Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5777202Z     await self._connection.execute(query)
2025-09-30T00:59:33.5777923Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5778690Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5779112Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5779512Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5779876Z     ???
2025-09-30T00:59:33.5782117Z E   RuntimeError: Task <Task pending name='Task-58' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5784782Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5785995Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e5cc140>>
2025-09-30T00:59:33.5787091Z Traceback (most recent call last):
2025-09-30T00:59:33.5788023Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5788903Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5789295Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5790271Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5791229Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5791571Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5792460Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5793656Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5794168Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5795110Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5796258Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5796917Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5797844Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5798748Z     value = await result
2025-09-30T00:59:33.5799049Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5799975Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5800929Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5801415Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5802266Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5803654Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5804685Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5805228Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5806010Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5806717Z     self._check_closed()
2025-09-30T00:59:33.5807018Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5807690Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5808877Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.5809934Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.5810500Z _______ ERROR at setup of TestIntegrationAPI.test_health_check_endpoint ________
2025-09-30T00:59:33.5811519Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5812393Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5812974Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5813668Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5814372Z     return future.result()
2025-09-30T00:59:33.5814694Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5815365Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5816180Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5816624Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5816998Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5817419Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5817792Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5818364Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5818960Z     return await anext(self.gen)
2025-09-30T00:59:33.5819284Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5819977Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5820720Z     async with conn:
2025-09-30T00:59:33.5820983Z                ^^^^
2025-09-30T00:59:33.5821645Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5822457Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5822983Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5823744Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5824575Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5825436Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5826284Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5826659Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5827333Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5828059Z     return self._connection_cls(self)
2025-09-30T00:59:33.5828594Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5829252Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5830151Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5830554Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5831281Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5832028Z     return self.pool.connect()
2025-09-30T00:59:33.5832330Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5833108Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5833817Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5834173Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5834847Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5835547Z     with util.safe_reraise():
2025-09-30T00:59:33.5835846Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5836524Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5837273Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5837962Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5838688Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5839462Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5840243Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5840600Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5841370Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5842195Z     dbapi_connection.ping()
2025-09-30T00:59:33.5843084Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5843877Z     self._handle_exception(error)
2025-09-30T00:59:33.5844719Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5845580Z     raise error
2025-09-30T00:59:33.5846252Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5847061Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5847401Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5848159Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5849205Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5849835Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5850639Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5851453Z     value = await result
2025-09-30T00:59:33.5851736Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5852496Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5853485Z     await tr.start()
2025-09-30T00:59:33.5854072Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5854786Z     await self._connection.execute(query)
2025-09-30T00:59:33.5855478Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5856244Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5856847Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5857230Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5857736Z     ???
2025-09-30T00:59:33.5859860Z E   RuntimeError: Task <Task pending name='Task-66' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5862413Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5863854Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e5cec60>>
2025-09-30T00:59:33.5865121Z Traceback (most recent call last):
2025-09-30T00:59:33.5866318Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5867286Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5867769Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5868876Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5869969Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5870470Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5871500Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5872659Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5873678Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5891243Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5892498Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5893548Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5894502Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5895417Z     value = await result
2025-09-30T00:59:33.5895729Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5896480Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5897279Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5897767Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5898621Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5899860Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5900891Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5901423Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5902219Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5903183Z     self._check_closed()
2025-09-30T00:59:33.5903484Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5904192Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5905329Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.5906414Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.5906948Z _______ ERROR at setup of TestIntegrationAPI.test_get_all_rooms_endpoint _______
2025-09-30T00:59:33.5908221Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.5909269Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.5909697Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5910386Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.5911108Z     return future.result()
2025-09-30T00:59:33.5911421Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5912060Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.5913118Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.5913591Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5913971Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.5914380Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.5914759Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5915308Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.5915885Z     return await anext(self.gen)
2025-09-30T00:59:33.5916186Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5916823Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.5917503Z     async with conn:
2025-09-30T00:59:33.5917753Z                ^^^^
2025-09-30T00:59:33.5918340Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.5919060Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.5919422Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5920070Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.5920784Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.5921555Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.5922316Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.5922654Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5923445Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.5924104Z     return self._connection_cls(self)
2025-09-30T00:59:33.5924429Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5925032Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.5925723Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.5926111Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5926793Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.5927498Z     return self.pool.connect()
2025-09-30T00:59:33.5927802Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5928373Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.5929040Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.5929381Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5930005Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.5930649Z     with util.safe_reraise():
2025-09-30T00:59:33.5930933Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5931564Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.5932266Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.5933051Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.5933896Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.5934752Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.5935470Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.5935807Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5936533Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.5937291Z     dbapi_connection.ping()
2025-09-30T00:59:33.5937976Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.5938705Z     self._handle_exception(error)
2025-09-30T00:59:33.5939487Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.5940270Z     raise error
2025-09-30T00:59:33.5940895Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.5941647Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.5941976Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5942676Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.5943771Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5944340Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5945070Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.5945804Z     value = await result
2025-09-30T00:59:33.5946072Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5946749Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.5947507Z     await tr.start()
2025-09-30T00:59:33.5948070Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.5948722Z     await self._connection.execute(query)
2025-09-30T00:59:33.5949366Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.5950060Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.5950441Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5950795Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.5951119Z     ???
2025-09-30T00:59:33.5953299Z E   RuntimeError: Task <Task pending name='Task-77' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.5955631Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.5956832Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e1dc050>>
2025-09-30T00:59:33.5959054Z Traceback (most recent call last):
2025-09-30T00:59:33.5962366Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.5966953Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.5967410Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.5968501Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.5969847Z     dbapi_connection.terminate()
2025-09-30T00:59:33.5970380Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5971342Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.5972424Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.5973137Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5974133Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.5975437Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.5976151Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.5977155Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.5978155Z     value = await result
2025-09-30T00:59:33.5978496Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.5979298Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.5980183Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.5980715Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.5981645Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.5983190Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.5987326Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.5987996Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.5988804Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.5989541Z     self._check_closed()
2025-09-30T00:59:33.5989852Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.5990554Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.5991725Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.6016330Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.6017366Z _________ ERROR at setup of TestIntegrationAPI.test_join_room_workflow _________
2025-09-30T00:59:33.6018519Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.6019544Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.6020021Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6020785Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.6021580Z     return future.result()
2025-09-30T00:59:33.6021920Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6022643Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.6033408Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.6033883Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6034267Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.6034698Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.6035067Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6035633Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.6036238Z     return await anext(self.gen)
2025-09-30T00:59:33.6036558Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6037265Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.6038240Z     async with conn:
2025-09-30T00:59:33.6038518Z                ^^^^
2025-09-30T00:59:33.6039362Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.6040155Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.6040543Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6041277Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.6042109Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.6064367Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.6065549Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.6065994Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6066817Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.6067670Z     return self._connection_cls(self)
2025-09-30T00:59:33.6068081Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6068846Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.6069706Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.6070170Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6071019Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.6071911Z     return self.pool.connect()
2025-09-30T00:59:33.6072284Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6073207Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.6074073Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.6074485Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6075226Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.6076036Z     with util.safe_reraise():
2025-09-30T00:59:33.6076401Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6077198Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.6078087Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.6078918Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.6079758Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.6080673Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.6081593Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.6082008Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6113889Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.6114888Z     dbapi_connection.ping()
2025-09-30T00:59:33.6116601Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.6117535Z     self._handle_exception(error)
2025-09-30T00:59:33.6118495Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.6119493Z     raise error
2025-09-30T00:59:33.6120928Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.6121995Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.6122349Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6123377Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.6124797Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.6125602Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6126388Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.6127207Z     value = await result
2025-09-30T00:59:33.6127498Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.6128263Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.6129097Z     await tr.start()
2025-09-30T00:59:33.6129701Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.6130390Z     await self._connection.execute(query)
2025-09-30T00:59:33.6131072Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.6131817Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.6132226Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6132607Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.6133252Z     ???
2025-09-30T00:59:33.6135412Z E   RuntimeError: Task <Task pending name='Task-89' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6137838Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.6139026Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e1dce60>>
2025-09-30T00:59:33.6140081Z Traceback (most recent call last):
2025-09-30T00:59:33.6141026Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.6141908Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.6142274Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.6143520Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.6145244Z     dbapi_connection.terminate()
2025-09-30T00:59:33.6145640Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.6146754Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.6147810Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.6148326Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6149247Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.6150380Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.6150994Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.6151910Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.6153663Z     value = await result
2025-09-30T00:59:33.6153995Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.6154727Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.6155491Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.6155978Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.6157053Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.6158428Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.6159419Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.6159953Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6160692Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.6161393Z     self._check_closed()
2025-09-30T00:59:33.6161693Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.6162345Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.6163834Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.6165079Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.6165606Z ________ ERROR at setup of TestIntegrationAPI.test_leave_room_workflow _________
2025-09-30T00:59:33.6166568Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:329: in _asyncgen_fixture_wrapper
2025-09-30T00:59:33.6167447Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T00:59:33.6167865Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6168538Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T00:59:33.6169215Z     return future.result()
2025-09-30T00:59:33.6169515Z            ^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6170129Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324: in setup
2025-09-30T00:59:33.6170917Z     res = await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T00:59:33.6171348Z           ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6171735Z tests/e2e/conftest.py:70: in async_db_session
2025-09-30T00:59:33.6172157Z     async with async_engine.begin() as conn:
2025-09-30T00:59:33.6172527Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6173304Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T00:59:33.6173914Z     return await anext(self.gen)
2025-09-30T00:59:33.6174234Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6174943Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T00:59:33.6175678Z     async with conn:
2025-09-30T00:59:33.6175946Z                ^^^^
2025-09-30T00:59:33.6176618Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T00:59:33.6177415Z     return await self.start(is_ctxmanager=True)
2025-09-30T00:59:33.6177802Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6178534Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T00:59:33.6179328Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T00:59:33.6180195Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T00:59:33.6181035Z     result = context.throw(*sys.exc_info())
2025-09-30T00:59:33.6181413Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6182096Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T00:59:33.6183069Z     return self._connection_cls(self)
2025-09-30T00:59:33.6183434Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6184093Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T00:59:33.6184835Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T00:59:33.6185461Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6186215Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T00:59:33.6187133Z     return self.pool.connect()
2025-09-30T00:59:33.6187458Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6188095Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T00:59:33.6188822Z     return _ConnectionFairy._checkout(self)
2025-09-30T00:59:33.6189187Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6189877Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T00:59:33.6190594Z     with util.safe_reraise():
2025-09-30T00:59:33.6190913Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6191596Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T00:59:33.6192378Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T00:59:33.6193281Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T00:59:33.6194015Z     result = pool._dialect._do_ping_w_event(
2025-09-30T00:59:33.6194804Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T00:59:33.6195612Z     return self.do_ping(dbapi_connection)
2025-09-30T00:59:33.6195978Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6196768Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T00:59:33.6197593Z     dbapi_connection.ping()
2025-09-30T00:59:33.6198316Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T00:59:33.6199119Z     self._handle_exception(error)
2025-09-30T00:59:33.6199995Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T00:59:33.6200854Z     raise error
2025-09-30T00:59:33.6201545Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T00:59:33.6202360Z     _ = self.await_(self._async_ping())
2025-09-30T00:59:33.6202702Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6203715Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T00:59:33.6204793Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.6205434Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6206260Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T00:59:33.6207100Z     value = await result
2025-09-30T00:59:33.6207409Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.6208209Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T00:59:33.6209039Z     await tr.start()
2025-09-30T00:59:33.6209640Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T00:59:33.6210342Z     await self._connection.execute(query)
2025-09-30T00:59:33.6211037Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T00:59:33.6211782Z     result = await self._protocol.query(query, timeout)
2025-09-30T00:59:33.6212207Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6212607Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T00:59:33.6213133Z     ???
2025-09-30T00:59:33.6215262Z E   RuntimeError: Task <Task pending name='Task-104' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6217932Z ------------------------------ Captured log setup ------------------------------
2025-09-30T00:59:33.6219102Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7f5c2e17c140>>
2025-09-30T00:59:33.6220192Z Traceback (most recent call last):
2025-09-30T00:59:33.6221081Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T00:59:33.6221935Z     self._dialect.do_terminate(connection)
2025-09-30T00:59:33.6222315Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T00:59:33.6223540Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T00:59:33.6224512Z     dbapi_connection.terminate()
2025-09-30T00:59:33.6224856Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.6225772Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T00:59:33.6226818Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T00:59:33.6227323Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6228252Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T00:59:33.6229414Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T00:59:33.6230080Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T00:59:33.6231033Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T00:59:33.6231959Z     value = await result
2025-09-30T00:59:33.6232261Z             ^^^^^^^^^^^^
2025-09-30T00:59:33.6233157Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T00:59:33.6233961Z     await self._protocol.close(timeout)
2025-09-30T00:59:33.6234479Z   File "asyncpg/protocol/protocol.pyx", line 627, in close
2025-09-30T00:59:33.6235354Z   File "asyncpg/protocol/protocol.pyx", line 660, in asyncpg.protocol.protocol.BaseProtocol._request_cancel
2025-09-30T00:59:33.6236615Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1673, in _cancel_current_command
2025-09-30T00:59:33.6237636Z     self._cancellations.add(self._loop.create_task(self._cancel(waiter)))
2025-09-30T00:59:33.6238209Z                             ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T00:59:33.6238999Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 466, in create_task
2025-09-30T00:59:33.6239730Z     self._check_closed()
2025-09-30T00:59:33.6240030Z     ~~~~~~~~~~~~~~~~~~^^
2025-09-30T00:59:33.6240714Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py", line 556, in _check_closed
2025-09-30T00:59:33.6241878Z ##[error]    raise RuntimeError('Event loop is closed')
2025-09-30T00:59:33.6243489Z RuntimeError: Event loop is closed
2025-09-30T00:59:33.6243933Z =========================== short test summary info ============================
2025-09-30T00:59:33.6246901Z ERROR tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_room_closure_workflow - RuntimeError: Task <Task pending name='Task-18' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6252539Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_message_xor_constraint - RuntimeError: Task <Task pending name='Task-28' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6258038Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_foreign_key_constraints - RuntimeError: Task <Task pending name='Task-38' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6263635Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_enum_validation - RuntimeError: Task <Task pending name='Task-48' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6268959Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_cascading_deletes - RuntimeError: Task <Task pending name='Task-58' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6274396Z ERROR tests/e2e/test_integration_api.py::TestIntegrationAPI::test_health_check_endpoint - RuntimeError: Task <Task pending name='Task-66' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6279634Z ERROR tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_all_rooms_endpoint - RuntimeError: Task <Task pending name='Task-77' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.6283281Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/_pytest/unraisableexception.py:33: RuntimeWarning: coroutine 'Connection._cancel' was never awaited
2025-09-30T00:59:33.6284322Z   gc.collect()
2025-09-30T00:59:33.6284775Z RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-09-30T00:59:33.7432505Z ERROR tests/e2e/test_integration_api.py::TestIntegrationAPI::test_join_room_workflow - RuntimeError: Task <Task pending name='Task-89' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.7441356Z ERROR tests/e2e/test_integration_api.py::TestIntegrationAPI::test_leave_room_workflow - RuntimeError: Task <Task pending name='Task-104' coro=<_wrap_asyncgen_fixture.<locals>._asyncgen_fixture_wrapper.<locals>.setup() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:324> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T00:59:33.7444534Z =================== 9 passed, 2 warnings, 9 errors in 7.30s ====================
2025-09-30T00:59:33.9023332Z ##[error]Process completed with exit code 1.

2025-09-30T01:33:51.7868981Z Current runner version: '2.328.0'
2025-09-30T01:33:51.7941545Z ##[group]Runner Image Provisioner
2025-09-30T01:33:51.7942644Z Hosted Compute Agent
2025-09-30T01:33:51.7943504Z Version: 20250912.392
2025-09-30T01:33:51.7944446Z Commit: d921fda672a98b64f4f82364647e2f10b2267d0b
2025-09-30T01:33:51.7945473Z Build Date: 2025-09-12T15:23:14Z
2025-09-30T01:33:51.7946388Z ##[endgroup]
2025-09-30T01:33:51.7947183Z ##[group]Operating System
2025-09-30T01:33:51.7947984Z Ubuntu
2025-09-30T01:33:51.7948652Z 24.04.3
2025-09-30T01:33:51.7949439Z LTS
2025-09-30T01:33:51.7950218Z ##[endgroup]
2025-09-30T01:33:51.7950929Z ##[group]Runner Image
2025-09-30T01:33:51.7951663Z Image: ubuntu-24.04
2025-09-30T01:33:51.7952460Z Version: 20250922.53.1
2025-09-30T01:33:51.7954020Z Included Software: https://github.com/actions/runner-images/blob/ubuntu24/20250922.53/images/ubuntu/Ubuntu2404-Readme.md
2025-09-30T01:33:51.7956466Z Image Release: https://github.com/actions/runner-images/releases/tag/ubuntu24%2F20250922.53
2025-09-30T01:33:51.7957920Z ##[endgroup]
2025-09-30T01:33:51.7980064Z ##[group]GITHUB_TOKEN Permissions
2025-09-30T01:33:51.7982742Z Contents: read
2025-09-30T01:33:51.7983500Z Metadata: read
2025-09-30T01:33:51.7984305Z Packages: read
2025-09-30T01:33:51.7985031Z ##[endgroup]
2025-09-30T01:33:51.7988071Z Secret source: Actions
2025-09-30T01:33:51.7989666Z Prepare workflow directory
2025-09-30T01:33:51.8883648Z Prepare all required actions
2025-09-30T01:33:51.9011719Z Getting action download info
2025-09-30T01:33:52.2726816Z Download action repository 'actions/checkout@v4' (SHA:08eba0b27e820071cde6df949e0beb9ba4906955)
2025-09-30T01:33:52.4262412Z Download action repository 'actions/setup-python@v4' (SHA:7f4fc3e22c37d6ff65e88745f38bd3157c663f7c)
2025-09-30T01:33:52.4974976Z Download action repository 'SonarSource/sonarqube-scan-action@master' (SHA:5ffbad44543237d1b339a5ed57a774432e19f3e4)
2025-09-30T01:33:53.1612702Z Complete job name: test
2025-09-30T01:33:53.2000539Z ##[group]Checking docker version
2025-09-30T01:33:53.2012973Z ##[command]/usr/bin/docker version --format '{{.Server.APIVersion}}'
2025-09-30T01:33:53.2736278Z '1.48'
2025-09-30T01:33:53.2744317Z Docker daemon API version: '1.48'
2025-09-30T01:33:53.2745166Z ##[command]/usr/bin/docker version --format '{{.Client.APIVersion}}'
2025-09-30T01:33:53.2902544Z '1.48'
2025-09-30T01:33:53.2910478Z Docker client API version: '1.48'
2025-09-30T01:33:53.2916599Z ##[endgroup]
2025-09-30T01:33:53.2921376Z ##[group]Clean up resources from previous jobs
2025-09-30T01:33:53.2926508Z ##[command]/usr/bin/docker ps --all --quiet --no-trunc --filter "label=71fb99"
2025-09-30T01:33:53.3056945Z ##[command]/usr/bin/docker network prune --force --filter "label=71fb99"
2025-09-30T01:33:53.3180934Z ##[endgroup]
2025-09-30T01:33:53.3181560Z ##[group]Create local container network
2025-09-30T01:33:53.3191609Z ##[command]/usr/bin/docker network create --label 71fb99 github_network_129d360d8a194ec6b3121a11e42977ca
2025-09-30T01:33:53.3744575Z 2065c7ba3b1d9f6ad8b65458f4adb2e65d54631ad4d8331eaa63616a6cafe5ee
2025-09-30T01:33:53.3758055Z ##[endgroup]
2025-09-30T01:33:53.3783119Z ##[group]Starting postgres service container
2025-09-30T01:33:53.3802180Z ##[command]/usr/bin/docker pull postgres:13
2025-09-30T01:33:54.1237690Z 13: Pulling from library/postgres
2025-09-30T01:33:54.3447359Z ce1261c6d567: Pulling fs layer
2025-09-30T01:33:54.3448370Z 13ace7265cdb: Pulling fs layer
2025-09-30T01:33:54.3455926Z fe812214d6b3: Pulling fs layer
2025-09-30T01:33:54.3456873Z 6d5e9f08e79c: Pulling fs layer
2025-09-30T01:33:54.3457783Z 843a44389b35: Pulling fs layer
2025-09-30T01:33:54.3458946Z 591035fb5d23: Pulling fs layer
2025-09-30T01:33:54.3459919Z ecbcc2c338b1: Pulling fs layer
2025-09-30T01:33:54.3460828Z d019f8b46d41: Pulling fs layer
2025-09-30T01:33:54.3461596Z bd20aae5d9de: Pulling fs layer
2025-09-30T01:33:54.3462446Z 90c552ec1b62: Pulling fs layer
2025-09-30T01:33:54.3463092Z 87d7240aa4c4: Pulling fs layer
2025-09-30T01:33:54.3463685Z 6f853c80e2f6: Pulling fs layer
2025-09-30T01:33:54.3464272Z 4dea4fb0ff58: Pulling fs layer
2025-09-30T01:33:54.3465062Z 2afbec19023b: Pulling fs layer
2025-09-30T01:33:54.3465664Z d019f8b46d41: Waiting
2025-09-30T01:33:54.3466172Z bd20aae5d9de: Waiting
2025-09-30T01:33:54.3466707Z 90c552ec1b62: Waiting
2025-09-30T01:33:54.3467265Z 87d7240aa4c4: Waiting
2025-09-30T01:33:54.3467773Z 6f853c80e2f6: Waiting
2025-09-30T01:33:54.3468232Z 4dea4fb0ff58: Waiting
2025-09-30T01:33:54.3468772Z 2afbec19023b: Waiting
2025-09-30T01:33:54.3469486Z 843a44389b35: Waiting
2025-09-30T01:33:54.3470004Z 591035fb5d23: Waiting
2025-09-30T01:33:54.3470540Z ecbcc2c338b1: Waiting
2025-09-30T01:33:54.3471016Z 6d5e9f08e79c: Waiting
2025-09-30T01:33:54.6141117Z 13ace7265cdb: Verifying Checksum
2025-09-30T01:33:54.6144065Z 13ace7265cdb: Download complete
2025-09-30T01:33:54.7148489Z fe812214d6b3: Verifying Checksum
2025-09-30T01:33:54.7149920Z fe812214d6b3: Download complete
2025-09-30T01:33:54.9663420Z 6d5e9f08e79c: Verifying Checksum
2025-09-30T01:33:54.9665045Z 6d5e9f08e79c: Download complete
2025-09-30T01:33:55.2777633Z 843a44389b35: Verifying Checksum
2025-09-30T01:33:55.2779775Z 843a44389b35: Download complete
2025-09-30T01:33:55.3018014Z 591035fb5d23: Verifying Checksum
2025-09-30T01:33:55.3019395Z 591035fb5d23: Download complete
2025-09-30T01:33:55.3383286Z ce1261c6d567: Verifying Checksum
2025-09-30T01:33:55.3385061Z ce1261c6d567: Download complete
2025-09-30T01:33:55.5715591Z ecbcc2c338b1: Verifying Checksum
2025-09-30T01:33:55.5718237Z ecbcc2c338b1: Download complete
2025-09-30T01:33:55.5798521Z d019f8b46d41: Verifying Checksum
2025-09-30T01:33:55.5800384Z d019f8b46d41: Download complete
2025-09-30T01:33:55.8542196Z 87d7240aa4c4: Verifying Checksum
2025-09-30T01:33:55.8550693Z 87d7240aa4c4: Download complete
2025-09-30T01:33:55.8557616Z 90c552ec1b62: Verifying Checksum
2025-09-30T01:33:55.8559337Z 90c552ec1b62: Download complete
2025-09-30T01:33:56.1280643Z 6f853c80e2f6: Verifying Checksum
2025-09-30T01:33:56.1284339Z 6f853c80e2f6: Download complete
2025-09-30T01:33:56.1394206Z 4dea4fb0ff58: Verifying Checksum
2025-09-30T01:33:56.1397269Z 4dea4fb0ff58: Download complete
2025-09-30T01:33:56.4107270Z 2afbec19023b: Verifying Checksum
2025-09-30T01:33:56.4112307Z 2afbec19023b: Download complete
2025-09-30T01:33:56.4335320Z ce1261c6d567: Pull complete
2025-09-30T01:33:57.7206608Z bd20aae5d9de: Verifying Checksum
2025-09-30T01:33:57.7208151Z bd20aae5d9de: Download complete
2025-09-30T01:33:58.2013383Z 13ace7265cdb: Pull complete
2025-09-30T01:33:58.6462624Z fe812214d6b3: Pull complete
2025-09-30T01:33:58.6896293Z 6d5e9f08e79c: Pull complete
2025-09-30T01:33:58.9897366Z 843a44389b35: Pull complete
2025-09-30T01:33:59.0657367Z 591035fb5d23: Pull complete
2025-09-30T01:33:59.0763443Z ecbcc2c338b1: Pull complete
2025-09-30T01:33:59.0856168Z d019f8b46d41: Pull complete
2025-09-30T01:34:02.6499090Z bd20aae5d9de: Pull complete
2025-09-30T01:34:02.7021070Z 90c552ec1b62: Pull complete
2025-09-30T01:34:02.7151714Z 87d7240aa4c4: Pull complete
2025-09-30T01:34:02.7264397Z 6f853c80e2f6: Pull complete
2025-09-30T01:34:02.7377318Z 4dea4fb0ff58: Pull complete
2025-09-30T01:34:02.7480030Z 2afbec19023b: Pull complete
2025-09-30T01:34:02.7530216Z Digest: sha256:9b0df1a5a48a93152e213022a977370d04add86e46abe3c420a978e49bad8032
2025-09-30T01:34:02.7537011Z Status: Downloaded newer image for postgres:13
2025-09-30T01:34:02.7547364Z docker.io/library/postgres:13
2025-09-30T01:34:02.7604752Z ##[command]/usr/bin/docker create --name 57e23b4e62c440d7b6e8150f6ba298ae_postgres13_6562e3 --label 71fb99 --network github_network_129d360d8a194ec6b3121a11e42977ca --network-alias postgres -p 5432:5432 --health-cmd pg_isready --health-interval 10s --health-timeout 5s --health-retries 5 -e "POSTGRES_USER=postgres" -e "POSTGRES_PASSWORD=postgres" -e "POSTGRES_DB=postgres" -e GITHUB_ACTIONS=true -e CI=true postgres:13
2025-09-30T01:34:02.7856942Z cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:02.7877901Z ##[command]/usr/bin/docker start cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:03.0994125Z cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:03.1022920Z ##[command]/usr/bin/docker ps --all --filter id=cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3 --filter status=running --no-trunc --format "{{.ID}} {{.Status}}"
2025-09-30T01:34:03.1172669Z cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3 Up Less than a second (health: starting)
2025-09-30T01:34:03.1200026Z ##[command]/usr/bin/docker port cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:03.1368498Z 5432/tcp -> 0.0.0.0:5432
2025-09-30T01:34:03.1369665Z 5432/tcp -> [::]:5432
2025-09-30T01:34:03.1437518Z ##[endgroup]
2025-09-30T01:34:03.1451571Z ##[group]Waiting for all services to be ready
2025-09-30T01:34:03.1469962Z ##[command]/usr/bin/docker inspect --format="{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}" cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:03.1713390Z starting
2025-09-30T01:34:03.1742972Z postgres service is starting, waiting 2 seconds before checking again.
2025-09-30T01:34:05.1746553Z ##[command]/usr/bin/docker inspect --format="{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}" cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:05.1938475Z starting
2025-09-30T01:34:05.1956419Z postgres service is starting, waiting 4 seconds before checking again.
2025-09-30T01:34:09.2788842Z ##[command]/usr/bin/docker inspect --format="{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}" cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:09.2916923Z starting
2025-09-30T01:34:09.2926257Z postgres service is starting, waiting 7 seconds before checking again.
2025-09-30T01:34:16.8934351Z ##[command]/usr/bin/docker inspect --format="{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}" cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:16.9095057Z healthy
2025-09-30T01:34:16.9115103Z postgres service is healthy.
2025-09-30T01:34:16.9116137Z ##[endgroup]
2025-09-30T01:34:16.9346919Z ##[group]Run actions/checkout@v4
2025-09-30T01:34:16.9347375Z with:
2025-09-30T01:34:16.9347576Z   repository: Sammyduzit/the_gathering_beta
2025-09-30T01:34:16.9347996Z   token: ***
2025-09-30T01:34:16.9348163Z   ssh-strict: true
2025-09-30T01:34:16.9348338Z   ssh-user: git
2025-09-30T01:34:16.9348520Z   persist-credentials: true
2025-09-30T01:34:16.9348717Z   clean: true
2025-09-30T01:34:16.9348913Z   sparse-checkout-cone-mode: true
2025-09-30T01:34:16.9349326Z   fetch-depth: 1
2025-09-30T01:34:16.9349569Z   fetch-tags: false
2025-09-30T01:34:16.9349750Z   show-progress: true
2025-09-30T01:34:16.9349922Z   lfs: false
2025-09-30T01:34:16.9350086Z   submodules: false
2025-09-30T01:34:16.9350260Z   set-safe-directory: true
2025-09-30T01:34:16.9350677Z env:
2025-09-30T01:34:16.9351076Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:16.9351302Z   CI: true
2025-09-30T01:34:16.9351471Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:16.9351708Z   ALGORITHM: HS256
2025-09-30T01:34:16.9351932Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:16.9352157Z   APP_NAME: The Gathering Test
2025-09-30T01:34:16.9352352Z   DEBUG: false
2025-09-30T01:34:16.9352528Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:16.9352753Z ##[endgroup]
2025-09-30T01:34:17.0406667Z Syncing repository: Sammyduzit/the_gathering_beta
2025-09-30T01:34:17.0407976Z ##[group]Getting Git version info
2025-09-30T01:34:17.0408357Z Working directory is '/home/runner/work/the_gathering_beta/the_gathering_beta'
2025-09-30T01:34:17.0409259Z [command]/usr/bin/git version
2025-09-30T01:34:17.0457031Z git version 2.51.0
2025-09-30T01:34:17.0481879Z ##[endgroup]
2025-09-30T01:34:17.0497381Z Temporarily overriding HOME='/home/runner/work/_temp/f27e3aef-306e-4a10-8b77-b08ffa7bf5df' before making global git config changes
2025-09-30T01:34:17.0500528Z Adding repository directory to the temporary git global config as a safe directory
2025-09-30T01:34:17.0515575Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/the_gathering_beta/the_gathering_beta
2025-09-30T01:34:17.0548480Z Deleting the contents of '/home/runner/work/the_gathering_beta/the_gathering_beta'
2025-09-30T01:34:17.0553126Z ##[group]Initializing the repository
2025-09-30T01:34:17.0557718Z [command]/usr/bin/git init /home/runner/work/the_gathering_beta/the_gathering_beta
2025-09-30T01:34:17.0656353Z hint: Using 'master' as the name for the initial branch. This default branch name
2025-09-30T01:34:17.0657938Z hint: is subject to change. To configure the initial branch name to use in all
2025-09-30T01:34:17.0658703Z hint: of your new repositories, which will suppress this warning, call:
2025-09-30T01:34:17.0659374Z hint:
2025-09-30T01:34:17.0659789Z hint: 	git config --global init.defaultBranch <name>
2025-09-30T01:34:17.0660255Z hint:
2025-09-30T01:34:17.0660646Z hint: Names commonly chosen instead of 'master' are 'main', 'trunk' and
2025-09-30T01:34:17.0661442Z hint: 'development'. The just-created branch can be renamed via this command:
2025-09-30T01:34:17.0661971Z hint:
2025-09-30T01:34:17.0662264Z hint: 	git branch -m <name>
2025-09-30T01:34:17.0662595Z hint:
2025-09-30T01:34:17.0663188Z hint: Disable this message with "git config set advice.defaultBranchName false"
2025-09-30T01:34:17.0666287Z Initialized empty Git repository in /home/runner/work/the_gathering_beta/the_gathering_beta/.git/
2025-09-30T01:34:17.0677642Z [command]/usr/bin/git remote add origin https://github.com/Sammyduzit/the_gathering_beta
2025-09-30T01:34:17.0712510Z ##[endgroup]
2025-09-30T01:34:17.0713097Z ##[group]Disabling automatic garbage collection
2025-09-30T01:34:17.0716238Z [command]/usr/bin/git config --local gc.auto 0
2025-09-30T01:34:17.0743308Z ##[endgroup]
2025-09-30T01:34:17.0744018Z ##[group]Setting up auth
2025-09-30T01:34:17.0750710Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-09-30T01:34:17.0778104Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-09-30T01:34:17.1058906Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-09-30T01:34:17.1086249Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-09-30T01:34:17.1258486Z [command]/usr/bin/git config --local http.https://github.com/.extraheader AUTHORIZATION: basic ***
2025-09-30T01:34:17.1287499Z ##[endgroup]
2025-09-30T01:34:17.1288355Z ##[group]Fetching the repository
2025-09-30T01:34:17.1305609Z [command]/usr/bin/git -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +9d81c6d23cf07ce83ac2dd493adcb2f1c613d1b8:refs/remotes/origin/main
2025-09-30T01:34:17.6633783Z From https://github.com/Sammyduzit/the_gathering_beta
2025-09-30T01:34:17.6638229Z  * [new ref]         9d81c6d23cf07ce83ac2dd493adcb2f1c613d1b8 -> origin/main
2025-09-30T01:34:17.6646080Z ##[endgroup]
2025-09-30T01:34:17.6646612Z ##[group]Determining the checkout info
2025-09-30T01:34:17.6648448Z ##[endgroup]
2025-09-30T01:34:17.6653952Z [command]/usr/bin/git sparse-checkout disable
2025-09-30T01:34:17.6690417Z [command]/usr/bin/git config --local --unset-all extensions.worktreeConfig
2025-09-30T01:34:17.6714336Z ##[group]Checking out the ref
2025-09-30T01:34:17.6718158Z [command]/usr/bin/git checkout --progress --force -B main refs/remotes/origin/main
2025-09-30T01:34:17.6788853Z Switched to a new branch 'main'
2025-09-30T01:34:17.6791673Z branch 'main' set up to track 'origin/main'.
2025-09-30T01:34:17.6795883Z ##[endgroup]
2025-09-30T01:34:17.6826232Z [command]/usr/bin/git log -1 --format=%H
2025-09-30T01:34:17.6844755Z 9d81c6d23cf07ce83ac2dd493adcb2f1c613d1b8
2025-09-30T01:34:17.7026333Z ##[group]Run actions/setup-python@v4
2025-09-30T01:34:17.7026688Z with:
2025-09-30T01:34:17.7026856Z   python-version: 3.13
2025-09-30T01:34:17.7027046Z   check-latest: false
2025-09-30T01:34:17.7027348Z   token: ***
2025-09-30T01:34:17.7027522Z   update-environment: true
2025-09-30T01:34:17.7027729Z   allow-prereleases: false
2025-09-30T01:34:17.7027924Z env:
2025-09-30T01:34:17.7028258Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:17.7028475Z   CI: true
2025-09-30T01:34:17.7028645Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:17.7028863Z   ALGORITHM: HS256
2025-09-30T01:34:17.7029041Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:17.7029523Z   APP_NAME: The Gathering Test
2025-09-30T01:34:17.7029764Z   DEBUG: false
2025-09-30T01:34:17.7029955Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:17.7030176Z ##[endgroup]
2025-09-30T01:34:17.8654168Z ##[group]Installed versions
2025-09-30T01:34:17.8751991Z Successfully set up CPython (3.13.7)
2025-09-30T01:34:17.8753155Z ##[endgroup]
2025-09-30T01:34:17.8850382Z ##[group]Run python -m pip install --upgrade pip
2025-09-30T01:34:17.8850825Z [36;1mpython -m pip install --upgrade pip[0m
2025-09-30T01:34:17.8851153Z [36;1mpip install -r requirements.txt[0m
2025-09-30T01:34:17.9003330Z shell: /usr/bin/bash -e {0}
2025-09-30T01:34:17.9003571Z env:
2025-09-30T01:34:17.9004039Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:17.9004277Z   CI: true
2025-09-30T01:34:17.9004454Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:17.9004686Z   ALGORITHM: HS256
2025-09-30T01:34:17.9004880Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:17.9005099Z   APP_NAME: The Gathering Test
2025-09-30T01:34:17.9005303Z   DEBUG: false
2025-09-30T01:34:17.9005484Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:17.9005777Z   pythonLocation: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:17.9006156Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib/pkgconfig
2025-09-30T01:34:17.9006569Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:17.9006890Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:17.9007203Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:17.9007521Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib
2025-09-30T01:34:17.9007782Z ##[endgroup]
2025-09-30T01:34:22.6289988Z Requirement already satisfied: pip in /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages (25.2)
2025-09-30T01:34:23.9256936Z Collecting fastapi==0.115.13 (from -r requirements.txt (line 1))
2025-09-30T01:34:24.0179552Z   Downloading fastapi-0.115.13-py3-none-any.whl.metadata (27 kB)
2025-09-30T01:34:24.0726047Z Collecting uvicorn==0.34.3 (from uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:24.0920695Z   Downloading uvicorn-0.34.3-py3-none-any.whl.metadata (6.5 kB)
2025-09-30T01:34:24.3668294Z Collecting sqlalchemy==2.0.41 (from -r requirements.txt (line 3))
2025-09-30T01:34:24.3868368Z   Downloading sqlalchemy-2.0.41-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (9.6 kB)
2025-09-30T01:34:24.4557454Z Collecting asyncpg==0.30.0 (from -r requirements.txt (line 4))
2025-09-30T01:34:24.4922821Z   Downloading asyncpg-0.30.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (5.0 kB)
2025-09-30T01:34:24.6139754Z Collecting greenlet==3.2.4 (from -r requirements.txt (line 5))
2025-09-30T01:34:24.6367624Z   Downloading greenlet-3.2.4-cp313-cp313-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (4.1 kB)
2025-09-30T01:34:24.7637848Z Collecting pydantic==2.11.7 (from -r requirements.txt (line 7))
2025-09-30T01:34:24.7872022Z   Downloading pydantic-2.11.7-py3-none-any.whl.metadata (67 kB)
2025-09-30T01:34:24.8361945Z Collecting pydantic-settings==2.9.1 (from -r requirements.txt (line 8))
2025-09-30T01:34:24.8773951Z   Downloading pydantic_settings-2.9.1-py3-none-any.whl.metadata (3.8 kB)
2025-09-30T01:34:24.9135388Z Collecting email-validator==2.2.0 (from -r requirements.txt (line 9))
2025-09-30T01:34:24.9455586Z   Downloading email_validator-2.2.0-py3-none-any.whl.metadata (25 kB)
2025-09-30T01:34:25.0022876Z Collecting bcrypt==4.3.0 (from -r requirements.txt (line 11))
2025-09-30T01:34:25.0317406Z   Downloading bcrypt-4.3.0-cp39-abi3-manylinux_2_34_x86_64.whl.metadata (10 kB)
2025-09-30T01:34:25.0642039Z Collecting PyJWT==2.10.1 (from -r requirements.txt (line 12))
2025-09-30T01:34:25.0864332Z   Downloading PyJWT-2.10.1-py3-none-any.whl.metadata (4.0 kB)
2025-09-30T01:34:25.1263182Z Collecting requests==2.32.4 (from -r requirements.txt (line 14))
2025-09-30T01:34:25.1467790Z   Downloading requests-2.32.4-py3-none-any.whl.metadata (4.9 kB)
2025-09-30T01:34:25.1933319Z Collecting pytest==8.4.1 (from -r requirements.txt (line 16))
2025-09-30T01:34:25.2133981Z   Downloading pytest-8.4.1-py3-none-any.whl.metadata (7.7 kB)
2025-09-30T01:34:25.2672495Z Collecting pytest-cov==6.2.1 (from -r requirements.txt (line 17))
2025-09-30T01:34:25.2977537Z   Downloading pytest_cov-6.2.1-py3-none-any.whl.metadata (30 kB)
2025-09-30T01:34:25.3383568Z Collecting pytest-asyncio==0.25.1 (from -r requirements.txt (line 18))
2025-09-30T01:34:25.3620723Z   Downloading pytest_asyncio-0.25.1-py3-none-any.whl.metadata (3.9 kB)
2025-09-30T01:34:25.3927860Z Collecting aiosqlite==0.20.0 (from -r requirements.txt (line 19))
2025-09-30T01:34:25.4190491Z   Downloading aiosqlite-0.20.0-py3-none-any.whl.metadata (4.3 kB)
2025-09-30T01:34:25.4545852Z Collecting anyio==4.11.0 (from -r requirements.txt (line 20))
2025-09-30T01:34:25.4898437Z   Downloading anyio-4.11.0-py3-none-any.whl.metadata (4.1 kB)
2025-09-30T01:34:25.5234884Z Collecting python-dotenv==1.1.0 (from -r requirements.txt (line 22))
2025-09-30T01:34:25.5535745Z   Downloading python_dotenv-1.1.0-py3-none-any.whl.metadata (24 kB)
2025-09-30T01:34:25.6223363Z Collecting markupsafe==3.0.2 (from -r requirements.txt (line 24))
2025-09-30T01:34:25.6445184Z   Downloading MarkupSafe-3.0.2-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)
2025-09-30T01:34:25.6810419Z Collecting httpx==0.28.1 (from -r requirements.txt (line 26))
2025-09-30T01:34:25.7017558Z   Downloading httpx-0.28.1-py3-none-any.whl.metadata (7.1 kB)
2025-09-30T01:34:26.0277888Z Collecting ruff==0.12.0 (from -r requirements.txt (line 28))
2025-09-30T01:34:26.0528424Z   Downloading ruff-0.12.0-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (25 kB)
2025-09-30T01:34:26.0933963Z Collecting deepl==1.22.0 (from -r requirements.txt (line 30))
2025-09-30T01:34:26.1180857Z   Downloading deepl-1.22.0-py3-none-any.whl.metadata (35 kB)
2025-09-30T01:34:26.1661395Z Collecting starlette<0.47.0,>=0.40.0 (from fastapi==0.115.13->-r requirements.txt (line 1))
2025-09-30T01:34:26.1863116Z   Downloading starlette-0.46.2-py3-none-any.whl.metadata (6.2 kB)
2025-09-30T01:34:26.2332597Z Collecting typing-extensions>=4.8.0 (from fastapi==0.115.13->-r requirements.txt (line 1))
2025-09-30T01:34:26.2536648Z   Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
2025-09-30T01:34:26.2824940Z Collecting annotated-types>=0.6.0 (from pydantic==2.11.7->-r requirements.txt (line 7))
2025-09-30T01:34:26.3036342Z   Downloading annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
2025-09-30T01:34:26.8757406Z Collecting pydantic-core==2.33.2 (from pydantic==2.11.7->-r requirements.txt (line 7))
2025-09-30T01:34:26.9082755Z   Downloading pydantic_core-2.33.2-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.8 kB)
2025-09-30T01:34:26.9381593Z Collecting typing-inspection>=0.4.0 (from pydantic==2.11.7->-r requirements.txt (line 7))
2025-09-30T01:34:26.9657428Z   Downloading typing_inspection-0.4.1-py3-none-any.whl.metadata (2.6 kB)
2025-09-30T01:34:26.9997391Z Collecting click>=7.0 (from uvicorn==0.34.3->uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:27.0267820Z   Downloading click-8.3.0-py3-none-any.whl.metadata (2.6 kB)
2025-09-30T01:34:27.0578526Z Collecting h11>=0.8 (from uvicorn==0.34.3->uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:27.0935814Z   Downloading h11-0.16.0-py3-none-any.whl.metadata (8.3 kB)
2025-09-30T01:34:27.1513969Z Collecting dnspython>=2.0.0 (from email-validator==2.2.0->-r requirements.txt (line 9))
2025-09-30T01:34:27.1733291Z   Downloading dnspython-2.8.0-py3-none-any.whl.metadata (5.7 kB)
2025-09-30T01:34:27.2197756Z Collecting idna>=2.0.0 (from email-validator==2.2.0->-r requirements.txt (line 9))
2025-09-30T01:34:27.2421218Z   Downloading idna-3.10-py3-none-any.whl.metadata (10 kB)
2025-09-30T01:34:27.3368195Z Collecting charset_normalizer<4,>=2 (from requests==2.32.4->-r requirements.txt (line 14))
2025-09-30T01:34:27.3561866Z   Downloading charset_normalizer-3.4.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (36 kB)
2025-09-30T01:34:27.4025316Z Collecting urllib3<3,>=1.21.1 (from requests==2.32.4->-r requirements.txt (line 14))
2025-09-30T01:34:27.4231038Z   Downloading urllib3-2.5.0-py3-none-any.whl.metadata (6.5 kB)
2025-09-30T01:34:27.4605081Z Collecting certifi>=2017.4.17 (from requests==2.32.4->-r requirements.txt (line 14))
2025-09-30T01:34:27.4798619Z   Downloading certifi-2025.8.3-py3-none-any.whl.metadata (2.4 kB)
2025-09-30T01:34:27.5063267Z Collecting iniconfig>=1 (from pytest==8.4.1->-r requirements.txt (line 16))
2025-09-30T01:34:27.5263294Z   Downloading iniconfig-2.1.0-py3-none-any.whl.metadata (2.7 kB)
2025-09-30T01:34:27.5689547Z Collecting packaging>=20 (from pytest==8.4.1->-r requirements.txt (line 16))
2025-09-30T01:34:27.5994094Z   Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
2025-09-30T01:34:27.6289121Z Collecting pluggy<2,>=1.5 (from pytest==8.4.1->-r requirements.txt (line 16))
2025-09-30T01:34:27.6479464Z   Downloading pluggy-1.6.0-py3-none-any.whl.metadata (4.8 kB)
2025-09-30T01:34:27.6851980Z Collecting pygments>=2.7.2 (from pytest==8.4.1->-r requirements.txt (line 16))
2025-09-30T01:34:27.7058006Z   Downloading pygments-2.19.2-py3-none-any.whl.metadata (2.5 kB)
2025-09-30T01:34:28.0152553Z Collecting coverage>=7.5 (from coverage[toml]>=7.5->pytest-cov==6.2.1->-r requirements.txt (line 17))
2025-09-30T01:34:28.0547600Z   Downloading coverage-7.10.7-cp313-cp313-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl.metadata (8.9 kB)
2025-09-30T01:34:28.1047171Z Collecting sniffio>=1.1 (from anyio==4.11.0->-r requirements.txt (line 20))
2025-09-30T01:34:28.1257320Z   Downloading sniffio-1.3.1-py3-none-any.whl.metadata (3.9 kB)
2025-09-30T01:34:28.1619004Z Collecting httpcore==1.* (from httpx==0.28.1->-r requirements.txt (line 26))
2025-09-30T01:34:28.1814982Z   Downloading httpcore-1.0.9-py3-none-any.whl.metadata (21 kB)
2025-09-30T01:34:28.2537574Z Collecting httptools>=0.6.3 (from uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:28.2855408Z   Downloading httptools-0.6.4-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.6 kB)
2025-09-30T01:34:28.3372064Z Collecting pyyaml>=5.1 (from uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:28.3810652Z   Downloading pyyaml-6.0.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.4 kB)
2025-09-30T01:34:28.4948201Z Collecting uvloop>=0.15.1 (from uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:28.5293905Z   Downloading uvloop-0.21.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.9 kB)
2025-09-30T01:34:28.6103981Z Collecting watchfiles>=0.13 (from uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:28.6536703Z   Downloading watchfiles-1.1.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.9 kB)
2025-09-30T01:34:28.7495182Z Collecting websockets>=10.4 (from uvicorn[standard]==0.34.3->-r requirements.txt (line 2))
2025-09-30T01:34:28.8006576Z   Downloading websockets-15.0.1-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.8 kB)
2025-09-30T01:34:28.8716333Z Downloading fastapi-0.115.13-py3-none-any.whl (95 kB)
2025-09-30T01:34:28.9180616Z Downloading pydantic-2.11.7-py3-none-any.whl (444 kB)
2025-09-30T01:34:29.0192916Z Downloading uvicorn-0.34.3-py3-none-any.whl (62 kB)
2025-09-30T01:34:29.0755734Z Downloading sqlalchemy-2.0.41-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.2 MB)
2025-09-30T01:34:29.3743704Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.2/3.2 MB 10.3 MB/s  0:00:00
2025-09-30T01:34:29.4143478Z Downloading asyncpg-0.30.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.6 MB)
2025-09-30T01:34:29.5062411Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.6/3.6 MB 38.1 MB/s  0:00:00
2025-09-30T01:34:29.5364193Z Downloading greenlet-3.2.4-cp313-cp313-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (610 kB)
2025-09-30T01:34:29.5754977Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 610.5/610.5 kB 10.6 MB/s  0:00:00
2025-09-30T01:34:29.7047002Z Downloading pydantic_settings-2.9.1-py3-none-any.whl (44 kB)
2025-09-30T01:34:29.8422433Z Downloading email_validator-2.2.0-py3-none-any.whl (33 kB)
2025-09-30T01:34:29.8963653Z Downloading bcrypt-4.3.0-cp39-abi3-manylinux_2_34_x86_64.whl (284 kB)
2025-09-30T01:34:29.9506055Z Downloading PyJWT-2.10.1-py3-none-any.whl (22 kB)
2025-09-30T01:34:30.0169923Z Downloading requests-2.32.4-py3-none-any.whl (64 kB)
2025-09-30T01:34:30.0571729Z Downloading pytest-8.4.1-py3-none-any.whl (365 kB)
2025-09-30T01:34:30.1198710Z Downloading pytest_cov-6.2.1-py3-none-any.whl (24 kB)
2025-09-30T01:34:30.1631344Z Downloading pytest_asyncio-0.25.1-py3-none-any.whl (19 kB)
2025-09-30T01:34:30.2030755Z Downloading aiosqlite-0.20.0-py3-none-any.whl (15 kB)
2025-09-30T01:34:30.2513999Z Downloading anyio-4.11.0-py3-none-any.whl (109 kB)
2025-09-30T01:34:30.2853981Z Downloading python_dotenv-1.1.0-py3-none-any.whl (20 kB)
2025-09-30T01:34:30.3137980Z Downloading MarkupSafe-3.0.2-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (23 kB)
2025-09-30T01:34:30.3727344Z Downloading httpx-0.28.1-py3-none-any.whl (73 kB)
2025-09-30T01:34:30.4423851Z Downloading ruff-0.12.0-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.6 MB)
2025-09-30T01:34:30.8671457Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.6/11.6 MB 28.6 MB/s  0:00:00
2025-09-30T01:34:30.8906742Z Downloading deepl-1.22.0-py3-none-any.whl (43 kB)
2025-09-30T01:34:30.9150771Z Downloading pydantic_core-2.33.2-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.0 MB)
2025-09-30T01:34:31.1017603Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 9.7 MB/s  0:00:00
2025-09-30T01:34:31.1482384Z Downloading charset_normalizer-3.4.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (151 kB)
2025-09-30T01:34:31.2209773Z Downloading httpcore-1.0.9-py3-none-any.whl (78 kB)
2025-09-30T01:34:31.2577896Z Downloading idna-3.10-py3-none-any.whl (70 kB)
2025-09-30T01:34:31.2909613Z Downloading pluggy-1.6.0-py3-none-any.whl (20 kB)
2025-09-30T01:34:31.3199406Z Downloading starlette-0.46.2-py3-none-any.whl (72 kB)
2025-09-30T01:34:31.3521889Z Downloading urllib3-2.5.0-py3-none-any.whl (129 kB)
2025-09-30T01:34:31.3788913Z Downloading annotated_types-0.7.0-py3-none-any.whl (13 kB)
2025-09-30T01:34:31.4032180Z Downloading certifi-2025.8.3-py3-none-any.whl (161 kB)
2025-09-30T01:34:31.4335214Z Downloading click-8.3.0-py3-none-any.whl (107 kB)
2025-09-30T01:34:31.4586387Z Downloading coverage-7.10.7-cp313-cp313-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl (252 kB)
2025-09-30T01:34:31.4947101Z Downloading dnspython-2.8.0-py3-none-any.whl (331 kB)
2025-09-30T01:34:31.5383432Z Downloading h11-0.16.0-py3-none-any.whl (37 kB)
2025-09-30T01:34:31.6089393Z Downloading httptools-0.6.4-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (473 kB)
2025-09-30T01:34:31.6589909Z Downloading iniconfig-2.1.0-py3-none-any.whl (6.0 kB)
2025-09-30T01:34:31.6816507Z Downloading packaging-25.0-py3-none-any.whl (66 kB)
2025-09-30T01:34:31.7381364Z Downloading pygments-2.19.2-py3-none-any.whl (1.2 MB)
2025-09-30T01:34:31.7490201Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 116.5 MB/s  0:00:00
2025-09-30T01:34:31.7808383Z Downloading pyyaml-6.0.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (801 kB)
2025-09-30T01:34:31.7991845Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 801.6/801.6 kB 35.8 MB/s  0:00:00
2025-09-30T01:34:31.8361798Z Downloading sniffio-1.3.1-py3-none-any.whl (10 kB)
2025-09-30T01:34:31.8584568Z Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
2025-09-30T01:34:31.8810710Z Downloading typing_inspection-0.4.1-py3-none-any.whl (14 kB)
2025-09-30T01:34:31.9250608Z Downloading uvloop-0.21.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.7 MB)
2025-09-30T01:34:32.0861646Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.7/4.7 MB 28.3 MB/s  0:00:00
2025-09-30T01:34:32.1105444Z Downloading watchfiles-1.1.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (451 kB)
2025-09-30T01:34:32.1414975Z Downloading websockets-15.0.1-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (182 kB)
2025-09-30T01:34:32.2844859Z Installing collected packages: websockets, uvloop, urllib3, typing-extensions, sniffio, ruff, pyyaml, python-dotenv, PyJWT, pygments, pluggy, packaging, markupsafe, iniconfig, idna, httptools, h11, greenlet, dnspython, coverage, click, charset_normalizer, certifi, bcrypt, asyncpg, annotated-types, uvicorn, typing-inspection, sqlalchemy, requests, pytest, pydantic-core, httpcore, email-validator, anyio, aiosqlite, watchfiles, starlette, pytest-cov, pytest-asyncio, pydantic, httpx, deepl, pydantic-settings, fastapi
2025-09-30T01:34:36.1780441Z 
2025-09-30T01:34:36.1814424Z Successfully installed PyJWT-2.10.1 aiosqlite-0.20.0 annotated-types-0.7.0 anyio-4.11.0 asyncpg-0.30.0 bcrypt-4.3.0 certifi-2025.8.3 charset_normalizer-3.4.3 click-8.3.0 coverage-7.10.7 deepl-1.22.0 dnspython-2.8.0 email-validator-2.2.0 fastapi-0.115.13 greenlet-3.2.4 h11-0.16.0 httpcore-1.0.9 httptools-0.6.4 httpx-0.28.1 idna-3.10 iniconfig-2.1.0 markupsafe-3.0.2 packaging-25.0 pluggy-1.6.0 pydantic-2.11.7 pydantic-core-2.33.2 pydantic-settings-2.9.1 pygments-2.19.2 pytest-8.4.1 pytest-asyncio-0.25.1 pytest-cov-6.2.1 python-dotenv-1.1.0 pyyaml-6.0.3 requests-2.32.4 ruff-0.12.0 sniffio-1.3.1 sqlalchemy-2.0.41 starlette-0.46.2 typing-extensions-4.15.0 typing-inspection-0.4.1 urllib3-2.5.0 uvicorn-0.34.3 uvloop-0.21.0 watchfiles-1.1.0 websockets-15.0.1
2025-09-30T01:34:36.5357710Z ##[group]Run ruff check app/ tests/ main.py
2025-09-30T01:34:36.5358031Z [36;1mruff check app/ tests/ main.py[0m
2025-09-30T01:34:36.5379087Z shell: /usr/bin/bash -e {0}
2025-09-30T01:34:36.5379647Z env:
2025-09-30T01:34:36.5380142Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:36.5380381Z   CI: true
2025-09-30T01:34:36.5380552Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:36.5380780Z   ALGORITHM: HS256
2025-09-30T01:34:36.5380973Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:36.5381190Z   APP_NAME: The Gathering Test
2025-09-30T01:34:36.5381414Z   DEBUG: false
2025-09-30T01:34:36.5381597Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:36.5381902Z   pythonLocation: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5382277Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib/pkgconfig
2025-09-30T01:34:36.5382624Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5382990Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5383298Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5383616Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib
2025-09-30T01:34:36.5383880Z ##[endgroup]
2025-09-30T01:34:36.5581990Z All checks passed!
2025-09-30T01:34:36.5610488Z ##[group]Run ruff format --check app/ tests/ main.py
2025-09-30T01:34:36.5610820Z [36;1mruff format --check app/ tests/ main.py[0m
2025-09-30T01:34:36.5631399Z shell: /usr/bin/bash -e {0}
2025-09-30T01:34:36.5631631Z env:
2025-09-30T01:34:36.5632204Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:36.5632436Z   CI: true
2025-09-30T01:34:36.5632612Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:36.5632838Z   ALGORITHM: HS256
2025-09-30T01:34:36.5633028Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:36.5633244Z   APP_NAME: The Gathering Test
2025-09-30T01:34:36.5633448Z   DEBUG: false
2025-09-30T01:34:36.5633637Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:36.5633941Z   pythonLocation: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5634318Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib/pkgconfig
2025-09-30T01:34:36.5634666Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5635054Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5635361Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5635681Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib
2025-09-30T01:34:36.5635952Z ##[endgroup]
2025-09-30T01:34:36.5839433Z 55 files already formatted
2025-09-30T01:34:36.5866640Z ##[group]Run pytest tests/unit/ -v --tb=short
2025-09-30T01:34:36.5866960Z [36;1mpytest tests/unit/ -v --tb=short[0m
2025-09-30T01:34:36.5886951Z shell: /usr/bin/bash -e {0}
2025-09-30T01:34:36.5887190Z env:
2025-09-30T01:34:36.5887697Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:36.5887942Z   CI: true
2025-09-30T01:34:36.5888121Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:36.5888354Z   ALGORITHM: HS256
2025-09-30T01:34:36.5888552Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:36.5888776Z   APP_NAME: The Gathering Test
2025-09-30T01:34:36.5888981Z   DEBUG: false
2025-09-30T01:34:36.5889347Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:36.5889677Z   pythonLocation: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5890055Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib/pkgconfig
2025-09-30T01:34:36.5890398Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5890774Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5891081Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:36.5891400Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib
2025-09-30T01:34:36.5891663Z ##[endgroup]
2025-09-30T01:34:38.3647326Z ============================= test session starts ==============================
2025-09-30T01:34:38.3648534Z platform linux -- Python 3.13.7, pytest-8.4.1, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.13.7/x64/bin/python
2025-09-30T01:34:38.3649818Z cachedir: .pytest_cache
2025-09-30T01:34:38.3650461Z rootdir: /home/runner/work/the_gathering_beta/the_gathering_beta
2025-09-30T01:34:38.3650919Z configfile: pytest.ini
2025-09-30T01:34:38.3651235Z plugins: anyio-4.11.0, asyncio-0.25.1, cov-6.2.1
2025-09-30T01:34:38.3651779Z asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=session
2025-09-30T01:34:39.1728991Z collecting ... collected 35 items
2025-09-30T01:34:39.1730673Z 
2025-09-30T01:34:39.1935926Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_process_message_translation_background_success PASSED [  2%]
2025-09-30T01:34:39.1967431Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_process_message_translation_background_disabled PASSED [  5%]
2025-09-30T01:34:39.2001342Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_process_message_translation_background_existing_translation PASSED [  8%]
2025-09-30T01:34:39.2036531Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_process_message_translation_background_translation_failure PASSED [ 11%]
2025-09-30T01:34:39.2066847Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_log_user_activity_background_success PASSED [ 14%]
2025-09-30T01:34:39.2095884Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_log_user_activity_background_without_details PASSED [ 17%]
2025-09-30T01:34:39.2122034Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_notify_room_users_background_success PASSED [ 20%]
2025-09-30T01:34:39.2150787Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_notify_room_users_background_no_exclusions PASSED [ 22%]
2025-09-30T01:34:39.2186626Z tests/unit/test_async_background_service.py::TestAsyncBackgroundService::test_background_task_error_logging PASSED [ 25%]
2025-09-30T01:34:39.2468973Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_create_user_success PASSED [ 28%]
2025-09-30T01:34:39.2672444Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_get_by_id_success PASSED [ 31%]
2025-09-30T01:34:39.2812229Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_get_by_id_not_found PASSED [ 34%]
2025-09-30T01:34:39.3003012Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_get_by_username_success PASSED [ 37%]
2025-09-30T01:34:39.3194320Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_get_by_email_success PASSED [ 40%]
2025-09-30T01:34:39.3391340Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_update_user_success PASSED [ 42%]
2025-09-30T01:34:39.3581413Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_username_exists_true PASSED [ 45%]
2025-09-30T01:34:39.3720221Z tests/unit/test_async_repositories.py::TestAsyncUserRepository::test_username_exists_false PASSED [ 48%]
2025-09-30T01:34:39.3871159Z tests/unit/test_async_repositories.py::TestAsyncRoomRepository::test_create_room_success PASSED [ 51%]
2025-09-30T01:34:39.4074862Z tests/unit/test_async_repositories.py::TestAsyncRoomRepository::test_get_active_rooms PASSED [ 54%]
2025-09-30T01:34:39.4263072Z tests/unit/test_async_repositories.py::TestAsyncRoomRepository::test_get_user_count PASSED [ 57%]
2025-09-30T01:34:39.4444898Z tests/unit/test_async_repositories.py::TestAsyncRoomRepository::test_update_room_success PASSED [ 60%]
2025-09-30T01:34:39.4673462Z tests/unit/test_async_repositories.py::TestAsyncMessageRepository::test_create_message_success PASSED [ 62%]
2025-09-30T01:34:39.4894146Z tests/unit/test_async_repositories.py::TestAsyncMessageRepository::test_get_room_messages_success PASSED [ 65%]
2025-09-30T01:34:39.5114610Z tests/unit/test_async_repositories.py::TestAsyncMessageRepository::test_get_conversation_messages_success PASSED [ 68%]
2025-09-30T01:34:39.5244515Z tests/unit/test_async_repositories.py::TestAsyncMessageRepository::test_get_all_messages_pagination PASSED [ 71%]
2025-09-30T01:34:39.5481285Z tests/unit/test_async_repositories.py::TestAsyncMessageRepository::test_exists_message PASSED [ 74%]
2025-09-30T01:34:39.5723516Z tests/unit/test_async_repositories.py::TestAsyncMessageRepository::test_delete_message_success PASSED [ 77%]
2025-09-30T01:34:39.5749976Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_translate_message_content_success PASSED [ 80%]
2025-09-30T01:34:39.5909679Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_translate_message_content_empty_content PASSED [ 82%]
2025-09-30T01:34:40.0325706Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_translate_message_content_invalid_language PASSED [ 85%]
2025-09-30T01:34:40.0369359Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_translate_multiple_languages_success PASSED [ 88%]
2025-09-30T01:34:40.0393174Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_translate_multiple_languages_empty_list PASSED [ 91%]
2025-09-30T01:34:40.0414079Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_get_existing_translation_found PASSED [ 94%]
2025-09-30T01:34:40.0435269Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_get_existing_translation_not_found PASSED [ 97%]
2025-09-30T01:34:40.1812682Z tests/unit/test_async_translation_service.py::TestAsyncTranslationService::test_translate_and_store_message_success PASSED [100%]
2025-09-30T01:34:40.1815702Z 
2025-09-30T01:34:40.1815955Z ======================== 35 passed, 1 warning in 1.69s =========================
2025-09-30T01:34:40.3093094Z ##[group]Run pytest tests/e2e/ -v --tb=short
2025-09-30T01:34:40.3093415Z [36;1mpytest tests/e2e/ -v --tb=short[0m
2025-09-30T01:34:40.3113443Z shell: /usr/bin/bash -e {0}
2025-09-30T01:34:40.3113672Z env:
2025-09-30T01:34:40.3114261Z   DATABASE_URL: ***localhost:5432/postgres
2025-09-30T01:34:40.3114507Z   CI: true
2025-09-30T01:34:40.3114686Z   SECRET_KEY: test-secret-key-for-ci
2025-09-30T01:34:40.3114926Z   ALGORITHM: HS256
2025-09-30T01:34:40.3115111Z   ACCESS_TOKEN_EXPIRE_MINUTES: 30
2025-09-30T01:34:40.3115336Z   APP_NAME: The Gathering Test
2025-09-30T01:34:40.3115544Z   DEBUG: false
2025-09-30T01:34:40.3115726Z   DEEPL_API_KEY: test-deepl-key-for-ci
2025-09-30T01:34:40.3116023Z   pythonLocation: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:40.3116400Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib/pkgconfig
2025-09-30T01:34:40.3116753Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:40.3117109Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:40.3117422Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.13.7/x64
2025-09-30T01:34:40.3117740Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.13.7/x64/lib
2025-09-30T01:34:40.3117998Z ##[endgroup]
2025-09-30T01:34:41.3220876Z ============================= test session starts ==============================
2025-09-30T01:34:41.3224124Z platform linux -- Python 3.13.7, pytest-8.4.1, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.13.7/x64/bin/python
2025-09-30T01:34:41.3227111Z cachedir: .pytest_cache
2025-09-30T01:34:41.3229931Z rootdir: /home/runner/work/the_gathering_beta/the_gathering_beta
2025-09-30T01:34:41.3232652Z configfile: pytest.ini
2025-09-30T01:34:41.3235421Z plugins: anyio-4.11.0, asyncio-0.25.1, cov-6.2.1
2025-09-30T01:34:41.3237913Z asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=session
2025-09-30T01:34:41.3771145Z collecting ... collected 18 items
2025-09-30T01:34:41.3772311Z 
2025-09-30T01:34:43.1662793Z tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_complete_chat_workflow FAILED [  5%]
2025-09-30T01:34:44.7306131Z tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_room_closure_workflow FAILED [ 11%]
2025-09-30T01:34:45.1890826Z tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_authentication_security FAILED [ 16%]
2025-09-30T01:34:46.1852654Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_message_xor_constraint FAILED [ 22%]
2025-09-30T01:34:46.1854910Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_message_xor_constraint ERROR [ 22%]
2025-09-30T01:34:46.9251779Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_unique_constraints ERROR [ 27%]
2025-09-30T01:34:47.4435311Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_foreign_key_constraints FAILED [ 33%]
2025-09-30T01:34:48.4223414Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_conversation_participant_constraints FAILED [ 38%]
2025-09-30T01:34:48.4226114Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_conversation_participant_constraints ERROR [ 38%]
2025-09-30T01:34:49.1592143Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_enum_validation ERROR [ 44%]
2025-09-30T01:34:50.3494026Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_nullable_constraints FAILED [ 50%]
2025-09-30T01:34:50.3497048Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_nullable_constraints ERROR [ 50%]
2025-09-30T01:34:51.0733317Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_cascading_deletes ERROR [ 55%]
2025-09-30T01:34:51.4694011Z tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_database_indexes_exist FAILED [ 61%]
2025-09-30T01:34:51.5404462Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_health_check_endpoint PASSED [ 66%]
2025-09-30T01:34:52.0697931Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_room_count_endpoint FAILED [ 72%]
2025-09-30T01:34:52.5850393Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_all_rooms_endpoint FAILED [ 77%]
2025-09-30T01:34:53.0935353Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_room_by_id_endpoint FAILED [ 83%]
2025-09-30T01:34:53.6737239Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_join_room_workflow FAILED [ 88%]
2025-09-30T01:34:54.1962936Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_send_and_get_messages_workflow FAILED [ 94%]
2025-09-30T01:34:54.8052886Z tests/e2e/test_integration_api.py::TestIntegrationAPI::test_leave_room_workflow FAILED [100%]
2025-09-30T01:34:54.8053908Z 
2025-09-30T01:34:54.8054342Z ==================================== ERRORS ====================================
2025-09-30T01:34:54.8055340Z ___ ERROR at teardown of TestDatabaseConstraints.test_message_xor_constraint ___
2025-09-30T01:34:54.8056697Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T01:34:54.8057810Z     _ = self.await_(self._async_ping())
2025-09-30T01:34:54.8058379Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8059683Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8061479Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8062451Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8063559Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8064698Z     value = await result
2025-09-30T01:34:54.8068279Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8076642Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T01:34:54.8077885Z     await tr.start()
2025-09-30T01:34:54.8078500Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:107: in start
2025-09-30T01:34:54.8092205Z     raise apg_errors.InterfaceError(
2025-09-30T01:34:54.8093104Z E   asyncpg.exceptions._base.InterfaceError: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8093840Z 
2025-09-30T01:34:54.8094138Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8095093Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.8096016Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.8096502Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8097426Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.8098339Z     return self.pool.connect()
2025-09-30T01:34:54.8098728Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8100331Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.8101196Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.8101643Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8102473Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.8103293Z     with util.safe_reraise():
2025-09-30T01:34:54.8103650Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8104482Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8105409Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8106531Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.8107414Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.8108466Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.8109582Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.8110015Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8110968Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.8111960Z     dbapi_connection.ping()
2025-09-30T01:34:54.8112808Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.8113728Z     self._handle_exception(error)
2025-09-30T01:34:54.8114739Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8115791Z     raise translated_error from error
2025-09-30T01:34:54.8117254Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8118579Z 
2025-09-30T01:34:54.8118889Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8119982Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:347: in finalizer
2025-09-30T01:34:54.8120855Z     event_loop.run_until_complete(task)
2025-09-30T01:34:54.8121647Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T01:34:54.8122425Z     return future.result()
2025-09-30T01:34:54.8122790Z            ^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8123608Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:338: in async_finalizer
2025-09-30T01:34:54.8124559Z     await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T01:34:54.8125041Z     ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8125457Z tests/e2e/conftest.py:76: in async_db_session
2025-09-30T01:34:54.8125943Z     async with async_engine.begin() as conn:
2025-09-30T01:34:54.8126374Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8127026Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T01:34:54.8127737Z     return await anext(self.gen)
2025-09-30T01:34:54.8128120Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8128952Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T01:34:54.8129877Z     async with conn:
2025-09-30T01:34:54.8130242Z                ^^^^
2025-09-30T01:34:54.8131002Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T01:34:54.8131958Z     return await self.start(is_ctxmanager=True)
2025-09-30T01:34:54.8132412Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8133434Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T01:34:54.8134390Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T01:34:54.8135422Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
2025-09-30T01:34:54.8136400Z     result = context.switch(value)
2025-09-30T01:34:54.8136799Z              ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8141300Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T01:34:54.8142165Z     return self._connection_cls(self)
2025-09-30T01:34:54.8142571Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8146752Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:147: in __init__
2025-09-30T01:34:54.8147911Z     Connection._handle_dbapi_exception_noconnection(
2025-09-30T01:34:54.8149258Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2436: in _handle_dbapi_exception_noconnection
2025-09-30T01:34:54.8152761Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.8153756Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.8154664Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.8155150Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8156046Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.8156957Z     return self.pool.connect()
2025-09-30T01:34:54.8157338Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8160465Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.8161353Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.8161801Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8162629Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.8163470Z     with util.safe_reraise():
2025-09-30T01:34:54.8163844Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8164673Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8167858Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8168706Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.8169697Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.8170638Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.8171608Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.8172039Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8175277Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.8176256Z     dbapi_connection.ping()
2025-09-30T01:34:54.8177161Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.8178120Z     self._handle_exception(error)
2025-09-30T01:34:54.8179265Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8182643Z     raise translated_error from error
2025-09-30T01:34:54.8184163Z E   sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8185807Z E   (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.8186585Z ______ ERROR at setup of TestDatabaseConstraints.test_unique_constraints _______
2025-09-30T01:34:54.8190299Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
2025-09-30T01:34:54.8191492Z     self._rows = deque(await prepared_stmt.fetch(*parameters))
2025-09-30T01:34:54.8192031Z                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8192831Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:176: in fetch
2025-09-30T01:34:54.8193561Z     data = await self.__bind_execute(args, 0, timeout)
2025-09-30T01:34:54.8193967Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8194781Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
2025-09-30T01:34:54.8195880Z     data, status, _ = await self.__do_execute(
2025-09-30T01:34:54.8196908Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
2025-09-30T01:34:54.8197778Z     return await executor(protocol)
2025-09-30T01:34:54.8198200Z            ^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8198666Z asyncpg/protocol/protocol.pyx:206: in bind_execute
2025-09-30T01:34:54.8199279Z     ???
2025-09-30T01:34:54.8200033Z E   asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8200916Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8204556Z 
2025-09-30T01:34:54.8204845Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8206144Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8207749Z     self.dialect.do_execute(
2025-09-30T01:34:54.8209352Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8210934Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8212608Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8214301Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8215875Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8218044Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8219432Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8221073Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8222722Z     value = await result
2025-09-30T01:34:54.8223279Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8224951Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8226814Z     self._handle_exception(error)
2025-09-30T01:34:54.8228543Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8230572Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8232426Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8234243Z     raise translated_error from error
2025-09-30T01:34:54.8236732Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8239533Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8240133Z 
2025-09-30T01:34:54.8240642Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8242467Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:375: in _async_fixture_wrapper
2025-09-30T01:34:54.8244149Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T01:34:54.8244956Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8246315Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T01:34:54.8247657Z     return future.result()
2025-09-30T01:34:54.8248220Z            ^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8249600Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:370: in setup
2025-09-30T01:34:54.8251264Z     res = await func(**_add_kwargs(func, kwargs, event_loop, request))
2025-09-30T01:34:54.8252409Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8253179Z tests/e2e/conftest.py:160: in created_user
2025-09-30T01:34:54.8254034Z     await async_db_session.commit()
2025-09-30T01:34:54.8255535Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.8257140Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.8258837Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
2025-09-30T01:34:54.8260624Z     result = context.switch(value)
2025-09-30T01:34:54.8261263Z              ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8262636Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.8264116Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.8265525Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.8267015Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.8267648Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8269018Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1313: in commit
2025-09-30T01:34:54.8270562Z     self._prepare_impl()
2025-09-30T01:34:54.8271772Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.8273295Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.8273931Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8275400Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
2025-09-30T01:34:54.8276930Z     self.session.flush()
2025-09-30T01:34:54.8278220Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4345: in flush
2025-09-30T01:34:54.8279673Z     self._flush(objects)
2025-09-30T01:34:54.8280253Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4480: in _flush
2025-09-30T01:34:54.8280936Z     with util.safe_reraise():
2025-09-30T01:34:54.8281233Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8281920Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8282657Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8283325Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4441: in _flush
2025-09-30T01:34:54.8284007Z     flush_context.execute()
2025-09-30T01:34:54.8284682Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
2025-09-30T01:34:54.8285384Z     rec.execute(self)
2025-09-30T01:34:54.8285994Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
2025-09-30T01:34:54.8286713Z     util.preloaded.orm_persistence.save_obj(
2025-09-30T01:34:54.8287430Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
2025-09-30T01:34:54.8288115Z     _emit_insert_statements(
2025-09-30T01:34:54.8288884Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
2025-09-30T01:34:54.8289814Z     result = connection.execute(
2025-09-30T01:34:54.8290448Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.8291103Z     return meth(
2025-09-30T01:34:54.8291758Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.8292581Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.8293356Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.8294319Z     ret = self._execute_context(
2025-09-30T01:34:54.8295210Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.8295944Z     return self._exec_single_context(
2025-09-30T01:34:54.8296678Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.8297407Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.8298168Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
2025-09-30T01:34:54.8299038Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.8300023Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8300786Z     self.dialect.do_execute(
2025-09-30T01:34:54.8301454Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8302191Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8302954Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8303750Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8304515Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8305532Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8306151Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8306920Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8307669Z     value = await result
2025-09-30T01:34:54.8307991Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8308779Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8309781Z     self._handle_exception(error)
2025-09-30T01:34:54.8310590Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8311463Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8312318Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8313145Z     raise translated_error from error
2025-09-30T01:34:54.8314320Z E   sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8315480Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8317081Z E   [SQL: INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at]
2025-09-30T01:34:54.8319412Z E   [parameters: ('user@example.com', 'testuser', '$2b$12$NxIQ.GNX527tipxO9yDXTOHP./wSI2SkYaMJKcFvpA7yTaAiR2a.q', None, 'en', 'AVAILABLE', True, datetime.datetime(2025, 9, 30, 1, 34, 46, 451953), False, None)]
2025-09-30T01:34:54.8320586Z E   (Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-30T01:34:54.8321287Z _ ERROR at teardown of TestDatabaseConstraints.test_conversation_participant_constraints _
2025-09-30T01:34:54.8322286Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T01:34:54.8323223Z     _ = self.await_(self._async_ping())
2025-09-30T01:34:54.8323564Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8324369Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8325382Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8325957Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8326717Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8327423Z     value = await result
2025-09-30T01:34:54.8327701Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8328441Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T01:34:54.8329415Z     await tr.start()
2025-09-30T01:34:54.8330018Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:107: in start
2025-09-30T01:34:54.8330708Z     raise apg_errors.InterfaceError(
2025-09-30T01:34:54.8331389Z E   asyncpg.exceptions._base.InterfaceError: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8331965Z 
2025-09-30T01:34:54.8332232Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8333016Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.8333754Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.8334209Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8334955Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.8335664Z     return self.pool.connect()
2025-09-30T01:34:54.8335963Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8336577Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.8337258Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.8337639Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8338308Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.8338972Z     with util.safe_reraise():
2025-09-30T01:34:54.8339410Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8340090Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8340813Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8341461Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.8342163Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.8342879Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.8343614Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.8343972Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8344738Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.8345512Z     dbapi_connection.ping()
2025-09-30T01:34:54.8346264Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.8347029Z     self._handle_exception(error)
2025-09-30T01:34:54.8347841Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8348686Z     raise translated_error from error
2025-09-30T01:34:54.8349933Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8351125Z 
2025-09-30T01:34:54.8351368Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8352368Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:347: in finalizer
2025-09-30T01:34:54.8353081Z     event_loop.run_until_complete(task)
2025-09-30T01:34:54.8353706Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T01:34:54.8354395Z     return future.result()
2025-09-30T01:34:54.8354696Z            ^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8355377Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:338: in async_finalizer
2025-09-30T01:34:54.8356212Z     await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T01:34:54.8356614Z     ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8356970Z tests/e2e/conftest.py:76: in async_db_session
2025-09-30T01:34:54.8357387Z     async with async_engine.begin() as conn:
2025-09-30T01:34:54.8357764Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8358317Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T01:34:54.8358900Z     return await anext(self.gen)
2025-09-30T01:34:54.8359382Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8360096Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T01:34:54.8360803Z     async with conn:
2025-09-30T01:34:54.8361071Z                ^^^^
2025-09-30T01:34:54.8361706Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T01:34:54.8362543Z     return await self.start(is_ctxmanager=True)
2025-09-30T01:34:54.8362923Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8363668Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T01:34:54.8364431Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T01:34:54.8365274Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
2025-09-30T01:34:54.8366079Z     result = context.switch(value)
2025-09-30T01:34:54.8366432Z              ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8367103Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T01:34:54.8367802Z     return self._connection_cls(self)
2025-09-30T01:34:54.8368134Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8368807Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:147: in __init__
2025-09-30T01:34:54.8372037Z     Connection._handle_dbapi_exception_noconnection(
2025-09-30T01:34:54.8372957Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2436: in _handle_dbapi_exception_noconnection
2025-09-30T01:34:54.8373913Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.8374708Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.8375432Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.8375853Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8376557Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.8377300Z     return self.pool.connect()
2025-09-30T01:34:54.8377620Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8378236Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.8378928Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.8379426Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8380298Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.8381008Z     with util.safe_reraise():
2025-09-30T01:34:54.8381415Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8382162Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8382956Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8383659Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.8384351Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.8385125Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.8385920Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.8386281Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8387102Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.8387958Z     dbapi_connection.ping()
2025-09-30T01:34:54.8388759Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.8389687Z     self._handle_exception(error)
2025-09-30T01:34:54.8390523Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8391302Z     raise translated_error from error
2025-09-30T01:34:54.8392459Z E   sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8393782Z E   (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.8394432Z ________ ERROR at setup of TestDatabaseConstraints.test_enum_validation ________
2025-09-30T01:34:54.8395482Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
2025-09-30T01:34:54.8396435Z     self._rows = deque(await prepared_stmt.fetch(*parameters))
2025-09-30T01:34:54.8396890Z                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8397578Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:176: in fetch
2025-09-30T01:34:54.8398325Z     data = await self.__bind_execute(args, 0, timeout)
2025-09-30T01:34:54.8398749Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8399639Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
2025-09-30T01:34:54.8400351Z     data, status, _ = await self.__do_execute(
2025-09-30T01:34:54.8401052Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
2025-09-30T01:34:54.8401753Z     return await executor(protocol)
2025-09-30T01:34:54.8402093Z            ^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8402497Z asyncpg/protocol/protocol.pyx:206: in bind_execute
2025-09-30T01:34:54.8402881Z     ???
2025-09-30T01:34:54.8403486Z E   asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8404229Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8404525Z 
2025-09-30T01:34:54.8404766Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8405669Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8406452Z     self.dialect.do_execute(
2025-09-30T01:34:54.8407168Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8407930Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8408865Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8409898Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8410667Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8411637Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8412269Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8412959Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8413690Z     value = await result
2025-09-30T01:34:54.8413981Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8414749Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8415551Z     self._handle_exception(error)
2025-09-30T01:34:54.8416335Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8417185Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8418090Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8418971Z     raise translated_error from error
2025-09-30T01:34:54.8420305Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8421549Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8421839Z 
2025-09-30T01:34:54.8422083Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8422955Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:375: in _async_fixture_wrapper
2025-09-30T01:34:54.8423782Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T01:34:54.8424198Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8424853Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T01:34:54.8425550Z     return future.result()
2025-09-30T01:34:54.8425853Z            ^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8426490Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:370: in setup
2025-09-30T01:34:54.8427256Z     res = await func(**_add_kwargs(func, kwargs, event_loop, request))
2025-09-30T01:34:54.8427728Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8428119Z tests/e2e/conftest.py:160: in created_user
2025-09-30T01:34:54.8428507Z     await async_db_session.commit()
2025-09-30T01:34:54.8429445Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.8430231Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.8431041Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
2025-09-30T01:34:54.8431840Z     result = context.switch(value)
2025-09-30T01:34:54.8432180Z              ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8432831Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.8433523Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.8434168Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.8434849Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.8435196Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8435847Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1313: in commit
2025-09-30T01:34:54.8436667Z     self._prepare_impl()
2025-09-30T01:34:54.8437402Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.8438124Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.8438454Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8439553Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
2025-09-30T01:34:54.8440281Z     self.session.flush()
2025-09-30T01:34:54.8440890Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4345: in flush
2025-09-30T01:34:54.8441558Z     self._flush(objects)
2025-09-30T01:34:54.8442164Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4480: in _flush
2025-09-30T01:34:54.8442839Z     with util.safe_reraise():
2025-09-30T01:34:54.8443163Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8443842Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8444572Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8445257Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4441: in _flush
2025-09-30T01:34:54.8445907Z     flush_context.execute()
2025-09-30T01:34:54.8446549Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
2025-09-30T01:34:54.8447210Z     rec.execute(self)
2025-09-30T01:34:54.8447811Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
2025-09-30T01:34:54.8448549Z     util.preloaded.orm_persistence.save_obj(
2025-09-30T01:34:54.8449447Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
2025-09-30T01:34:54.8450173Z     _emit_insert_statements(
2025-09-30T01:34:54.8450947Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
2025-09-30T01:34:54.8451758Z     result = connection.execute(
2025-09-30T01:34:54.8452429Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.8453109Z     return meth(
2025-09-30T01:34:54.8453771Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.8454571Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.8455364Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.8456121Z     ret = self._execute_context(
2025-09-30T01:34:54.8456812Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.8457566Z     return self._exec_single_context(
2025-09-30T01:34:54.8458293Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.8459036Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.8459866Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
2025-09-30T01:34:54.8460727Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.8461581Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8462320Z     self.dialect.do_execute(
2025-09-30T01:34:54.8462996Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8463746Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8464525Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8465524Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8466349Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8467413Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8468009Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8468761Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8469670Z     value = await result
2025-09-30T01:34:54.8469960Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8470718Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8471532Z     self._handle_exception(error)
2025-09-30T01:34:54.8472369Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8473274Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8474169Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8475029Z     raise translated_error from error
2025-09-30T01:34:54.8476213Z E   sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8477483Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8479780Z E   [SQL: INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at]
2025-09-30T01:34:54.8482000Z E   [parameters: ('user@example.com', 'testuser', '$2b$12$nT55XU0jHBuETVUIMEl9KuZe.usHUDo9WPAO.nM8u9ra1bNWNkujm', None, 'en', 'AVAILABLE', True, datetime.datetime(2025, 9, 30, 1, 34, 48, 688810), False, None)]
2025-09-30T01:34:54.8483203Z E   (Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-30T01:34:54.8483839Z ____ ERROR at teardown of TestDatabaseConstraints.test_nullable_constraints ____
2025-09-30T01:34:54.8484793Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T01:34:54.8485566Z     _ = self.await_(self._async_ping())
2025-09-30T01:34:54.8485904Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8486633Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8487628Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8488221Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8489100Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8490014Z     value = await result
2025-09-30T01:34:54.8490307Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8491080Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T01:34:54.8491864Z     await tr.start()
2025-09-30T01:34:54.8492461Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:107: in start
2025-09-30T01:34:54.8493116Z     raise apg_errors.InterfaceError(
2025-09-30T01:34:54.8493815Z E   asyncpg.exceptions._base.InterfaceError: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8494547Z 
2025-09-30T01:34:54.8494802Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8495665Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.8496431Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.8496839Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8497557Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.8498293Z     return self.pool.connect()
2025-09-30T01:34:54.8498627Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8499402Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.8500118Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.8500507Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8501172Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.8501898Z     with util.safe_reraise():
2025-09-30T01:34:54.8502205Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8502931Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8503738Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8504457Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.8505177Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.8505943Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.8506679Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.8507035Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8507871Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.8508688Z     dbapi_connection.ping()
2025-09-30T01:34:54.8509564Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.8510380Z     self._handle_exception(error)
2025-09-30T01:34:54.8511280Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8512134Z     raise translated_error from error
2025-09-30T01:34:54.8513326Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8514444Z 
2025-09-30T01:34:54.8514706Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8515557Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:347: in finalizer
2025-09-30T01:34:54.8516293Z     event_loop.run_until_complete(task)
2025-09-30T01:34:54.8516947Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T01:34:54.8517591Z     return future.result()
2025-09-30T01:34:54.8517897Z            ^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8518549Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:338: in async_finalizer
2025-09-30T01:34:54.8519493Z     await gen_obj.__anext__()  # type: ignore[union-attr]
2025-09-30T01:34:54.8519882Z     ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8520220Z tests/e2e/conftest.py:76: in async_db_session
2025-09-30T01:34:54.8520651Z     async with async_engine.begin() as conn:
2025-09-30T01:34:54.8520997Z                ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8521547Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/contextlib.py:214: in __aenter__
2025-09-30T01:34:54.8522118Z     return await anext(self.gen)
2025-09-30T01:34:54.8522594Z            ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8523342Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:1066: in begin
2025-09-30T01:34:54.8524063Z     async with conn:
2025-09-30T01:34:54.8524331Z                ^^^^
2025-09-30T01:34:54.8524992Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/base.py:121: in __aenter__
2025-09-30T01:34:54.8525776Z     return await self.start(is_ctxmanager=True)
2025-09-30T01:34:54.8526184Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8526960Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/engine.py:274: in start
2025-09-30T01:34:54.8527770Z     await greenlet_spawn(self.sync_engine.connect)
2025-09-30T01:34:54.8528693Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
2025-09-30T01:34:54.8529617Z     result = context.switch(value)
2025-09-30T01:34:54.8529961Z              ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8530654Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T01:34:54.8531348Z     return self._connection_cls(self)
2025-09-30T01:34:54.8531719Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8532429Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:147: in __init__
2025-09-30T01:34:54.8533241Z     Connection._handle_dbapi_exception_noconnection(
2025-09-30T01:34:54.8534210Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2436: in _handle_dbapi_exception_noconnection
2025-09-30T01:34:54.8535140Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.8535894Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.8536595Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.8536973Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8537655Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.8538381Z     return self.pool.connect()
2025-09-30T01:34:54.8538705Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8539485Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.8540226Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.8540606Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8541273Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.8541982Z     with util.safe_reraise():
2025-09-30T01:34:54.8542294Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8542992Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8543796Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8544546Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.8545211Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.8545963Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.8546737Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.8547116Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8547892Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.8548688Z     dbapi_connection.ping()
2025-09-30T01:34:54.8549541Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.8550523Z     self._handle_exception(error)
2025-09-30T01:34:54.8551476Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8552379Z     raise translated_error from error
2025-09-30T01:34:54.8553582Z E   sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.8555012Z E   (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.8555573Z ---------------------------- Captured log teardown -----------------------------
2025-09-30T01:34:54.8556097Z ERROR    asyncio:base_events.py:1879 Future exception was never retrieved
2025-09-30T01:34:54.8557039Z future: <Future finished exception=NotNullViolationError('null value in column "email" of relation "users" violates not-null constraint')>
2025-09-30T01:34:54.8558114Z asyncpg.exceptions.NotNullViolationError: null value in column "email" of relation "users" violates not-null constraint
2025-09-30T01:34:54.8559673Z DETAIL:  Failing row contains (2, null, testuser, $2b$12$vqk30WxgUiW48mxTwyhTQux9f83GwkN.xzo3BkeWoplQf4emvUDHK, null, en, AVAILABLE, t, 2025-09-30 01:34:49.463713+00, 2025-09-30 01:34:49.718755+00, f, null).
2025-09-30T01:34:54.8560822Z _______ ERROR at setup of TestDatabaseConstraints.test_cascading_deletes _______
2025-09-30T01:34:54.8561867Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:545: in _prepare_and_execute
2025-09-30T01:34:54.8562838Z     self._rows = deque(await prepared_stmt.fetch(*parameters))
2025-09-30T01:34:54.8563307Z                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8564017Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:176: in fetch
2025-09-30T01:34:54.8564754Z     data = await self.__bind_execute(args, 0, timeout)
2025-09-30T01:34:54.8565180Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8565934Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:267: in __bind_execute
2025-09-30T01:34:54.8566711Z     data, status, _ = await self.__do_execute(
2025-09-30T01:34:54.8567476Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/prepared_stmt.py:256: in __do_execute
2025-09-30T01:34:54.8568238Z     return await executor(protocol)
2025-09-30T01:34:54.8568550Z            ^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8568922Z asyncpg/protocol/protocol.pyx:206: in bind_execute
2025-09-30T01:34:54.8569446Z     ???
2025-09-30T01:34:54.8570085Z E   asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8570902Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8571446Z 
2025-09-30T01:34:54.8571876Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8573605Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8575029Z     self.dialect.do_execute(
2025-09-30T01:34:54.8576164Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8577547Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8579118Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8581461Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8582860Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8584705Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8585832Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8587390Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8588899Z     value = await result
2025-09-30T01:34:54.8589516Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8590932Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8592411Z     self._handle_exception(error)
2025-09-30T01:34:54.8593849Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8595445Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8597023Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8598539Z     raise translated_error from error
2025-09-30T01:34:54.8600788Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8605601Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8606128Z 
2025-09-30T01:34:54.8606530Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.8607979Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:375: in _async_fixture_wrapper
2025-09-30T01:34:54.8609552Z     result = event_loop.run_until_complete(setup_task)
2025-09-30T01:34:54.8610217Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8611406Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:725: in run_until_complete
2025-09-30T01:34:54.8612634Z     return future.result()
2025-09-30T01:34:54.8613101Z            ^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8614049Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/pytest_asyncio/plugin.py:370: in setup
2025-09-30T01:34:54.8615387Z     res = await func(**_add_kwargs(func, kwargs, event_loop, request))
2025-09-30T01:34:54.8616226Z           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8616925Z tests/e2e/conftest.py:160: in created_user
2025-09-30T01:34:54.8617586Z     await async_db_session.commit()
2025-09-30T01:34:54.8618854Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.8620661Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.8622235Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:203: in greenlet_spawn
2025-09-30T01:34:54.8623632Z     result = context.switch(value)
2025-09-30T01:34:54.8624063Z              ^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8624947Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.8625933Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.8626898Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.8627969Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.8628408Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8629480Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1313: in commit
2025-09-30T01:34:54.8630474Z     self._prepare_impl()
2025-09-30T01:34:54.8631437Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.8632466Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.8632927Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8633929Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
2025-09-30T01:34:54.8635176Z     self.session.flush()
2025-09-30T01:34:54.8636018Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4345: in flush
2025-09-30T01:34:54.8637051Z     self._flush(objects)
2025-09-30T01:34:54.8637909Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4480: in _flush
2025-09-30T01:34:54.8638891Z     with util.safe_reraise():
2025-09-30T01:34:54.8639480Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8640439Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.8641469Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.8642472Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4441: in _flush
2025-09-30T01:34:54.8643411Z     flush_context.execute()
2025-09-30T01:34:54.8644306Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:466: in execute
2025-09-30T01:34:54.8645368Z     rec.execute(self)
2025-09-30T01:34:54.8646261Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py:642: in execute
2025-09-30T01:34:54.8647265Z     util.preloaded.orm_persistence.save_obj(
2025-09-30T01:34:54.8648341Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:93: in save_obj
2025-09-30T01:34:54.8649490Z     _emit_insert_statements(
2025-09-30T01:34:54.8650631Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py:1233: in _emit_insert_statements
2025-09-30T01:34:54.8651731Z     result = connection.execute(
2025-09-30T01:34:54.8652750Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.8653615Z     return meth(
2025-09-30T01:34:54.8654583Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.8655756Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.8657072Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.8658011Z     ret = self._execute_context(
2025-09-30T01:34:54.8659003Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.8660270Z     return self._exec_single_context(
2025-09-30T01:34:54.8661363Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.8662448Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.8663667Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
2025-09-30T01:34:54.8664927Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.8666182Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8667374Z     self.dialect.do_execute(
2025-09-30T01:34:54.8668323Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8669514Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8670796Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8672199Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8673754Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8675685Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8676899Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8678704Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8680851Z     value = await result
2025-09-30T01:34:54.8681646Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8683528Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8685588Z     self._handle_exception(error)
2025-09-30T01:34:54.8687501Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8689723Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8691800Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.8693819Z     raise translated_error from error
2025-09-30T01:34:54.8696699Z E   sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.8699854Z E   DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.8703579Z E   [SQL: INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at]
2025-09-30T01:34:54.8708817Z E   [parameters: ('user@example.com', 'testuser', '$2b$12$BGFzZsF4tNm7.hmvv1w96.i.Rxf5vzFIXX5VL73oGmZBZvpwkaFWe', None, 'en', 'AVAILABLE', True, datetime.datetime(2025, 9, 30, 1, 34, 50, 617443), False, None)]
2025-09-30T01:34:54.8711652Z E   (Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-30T01:34:54.8712718Z =================================== FAILURES ===================================
2025-09-30T01:34:54.8714016Z _____________ TestCriticalUserJourneys.test_complete_chat_workflow _____________
2025-09-30T01:34:54.8715592Z tests/e2e/test_critical_workflows.py:24: in test_complete_chat_workflow
2025-09-30T01:34:54.8716496Z     room_response = await async_client.post(
2025-09-30T01:34:54.8717090Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1859: in post
2025-09-30T01:34:54.8719503Z     return await self.request(
2025-09-30T01:34:54.8720200Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.8721078Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.8721992Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8723124Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.8724248Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.8725558Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.8726926Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.8728342Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.8729891Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.8730580Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8731811Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.8733224Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.8733989Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8735314Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.8736924Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.8738299Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.8767149Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.8767969Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.8768714Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.8769689Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.8770362Z     raise exc
2025-09-30T01:34:54.8770987Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.8771733Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.8772481Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.8773408Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.8774288Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.8775013Z     raise exc
2025-09-30T01:34:54.8775651Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.8776377Z     await app(scope, receive, sender)
2025-09-30T01:34:54.8777032Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.8777765Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.8778459Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.8780029Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.8780730Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.8781334Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.8781950Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.8782746Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.8783586Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.8784288Z     raise exc
2025-09-30T01:34:54.8784904Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.8785651Z     await app(scope, receive, sender)
2025-09-30T01:34:54.8786296Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.8786943Z     response = await f(request)
2025-09-30T01:34:54.8787270Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8787881Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:291: in app
2025-09-30T01:34:54.8788509Z     solved_result = await solve_dependencies(
2025-09-30T01:34:54.8789436Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/dependencies/utils.py:615: in solve_dependencies
2025-09-30T01:34:54.8790263Z     solved_result = await solve_dependencies(
2025-09-30T01:34:54.8791017Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/dependencies/utils.py:615: in solve_dependencies
2025-09-30T01:34:54.8791800Z     solved_result = await solve_dependencies(
2025-09-30T01:34:54.8792544Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
2025-09-30T01:34:54.8793360Z     solved = await call(**solved_result.values)
2025-09-30T01:34:54.8793728Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8794387Z app/core/auth_dependencies.py:41: in get_current_user
2025-09-30T01:34:54.8794847Z     user = await user_repo.get_by_username(username)
2025-09-30T01:34:54.8795347Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8795777Z app/repositories/user_repository.py:70: in get_by_username
2025-09-30T01:34:54.8796240Z     result = await self.db.execute(query)
2025-09-30T01:34:54.8796605Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8797304Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.8798063Z     result = await greenlet_spawn(
2025-09-30T01:34:54.8798905Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.8799935Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.8800308Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8800944Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.8801644Z     return self._execute_internal(
2025-09-30T01:34:54.8802386Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.8803199Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.8804051Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.8804798Z     result = conn.execute(
2025-09-30T01:34:54.8805416Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.8806062Z     return meth(
2025-09-30T01:34:54.8806714Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.8807512Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.8808309Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.8809116Z     ret = self._execute_context(
2025-09-30T01:34:54.8810409Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.8811154Z     return self._exec_single_context(
2025-09-30T01:34:54.8811893Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.8812654Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.8813408Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.8814242Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.8815018Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8815793Z     self.dialect.do_execute(
2025-09-30T01:34:54.8816504Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8817271Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8818107Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8818927Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8819933Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8821058Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8821682Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8822456Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8823412Z     value = await result
2025-09-30T01:34:54.8823725Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8824680Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8825558Z     self._handle_exception(error)
2025-09-30T01:34:54.8826426Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8827466Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8828340Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.8829313Z     raise error
2025-09-30T01:34:54.8830120Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.8831132Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.8832057Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.8832904Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.8833624Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.8834292Z     return await self._prepare(
2025-09-30T01:34:54.8834942Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.8835628Z     stmt = await self._get_statement(
2025-09-30T01:34:54.8836331Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.8837082Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.8837504Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.8837861Z     ???
2025-09-30T01:34:54.8840255Z E   RuntimeError: Task <Task pending name='Task-8' coro=<TestCriticalUserJourneys.test_complete_chat_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_critical_workflows.py:24> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.8842902Z _____________ TestCriticalUserJourneys.test_room_closure_workflow ______________
2025-09-30T01:34:54.8843577Z tests/e2e/test_critical_workflows.py:95: in test_room_closure_workflow
2025-09-30T01:34:54.8844142Z     room_response = await async_client.post(
2025-09-30T01:34:54.8844781Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1859: in post
2025-09-30T01:34:54.8845490Z     return await self.request(
2025-09-30T01:34:54.8846147Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.8847051Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.8847625Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8848237Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.8848912Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.8849767Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.8850467Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.8851205Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.8851958Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.8852373Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8853272Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.8854167Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.8854619Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8855403Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.8856207Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.8856953Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.8857697Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.8858378Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.8859080Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.8860090Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.8860797Z     raise exc
2025-09-30T01:34:54.8861445Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.8862170Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.8862896Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.8863864Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.8864803Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.8865548Z     raise exc
2025-09-30T01:34:54.8866195Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.8866964Z     await app(scope, receive, sender)
2025-09-30T01:34:54.8867690Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.8868378Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.8869065Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.8869840Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.8870457Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.8871103Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.8871713Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.8872432Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.8873263Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.8874017Z     raise exc
2025-09-30T01:34:54.8874655Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.8875416Z     await app(scope, receive, sender)
2025-09-30T01:34:54.8876059Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.8876731Z     response = await f(request)
2025-09-30T01:34:54.8877025Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8877550Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:291: in app
2025-09-30T01:34:54.8878172Z     solved_result = await solve_dependencies(
2025-09-30T01:34:54.8878995Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/dependencies/utils.py:615: in solve_dependencies
2025-09-30T01:34:54.8880005Z     solved_result = await solve_dependencies(
2025-09-30T01:34:54.8880829Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/dependencies/utils.py:615: in solve_dependencies
2025-09-30T01:34:54.8881834Z     solved_result = await solve_dependencies(
2025-09-30T01:34:54.8882723Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
2025-09-30T01:34:54.8883542Z     solved = await call(**solved_result.values)
2025-09-30T01:34:54.8883908Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8884342Z app/core/auth_dependencies.py:41: in get_current_user
2025-09-30T01:34:54.8884819Z     user = await user_repo.get_by_username(username)
2025-09-30T01:34:54.8885211Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8885656Z app/repositories/user_repository.py:70: in get_by_username
2025-09-30T01:34:54.8886101Z     result = await self.db.execute(query)
2025-09-30T01:34:54.8886457Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8887173Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.8887971Z     result = await greenlet_spawn(
2025-09-30T01:34:54.8888759Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.8889742Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.8890116Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8890778Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.8891464Z     return self._execute_internal(
2025-09-30T01:34:54.8892171Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.8893020Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.8893901Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.8894683Z     result = conn.execute(
2025-09-30T01:34:54.8895320Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.8895986Z     return meth(
2025-09-30T01:34:54.8896685Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.8897497Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.8898308Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.8899074Z     ret = self._execute_context(
2025-09-30T01:34:54.8899934Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.8900681Z     return self._exec_single_context(
2025-09-30T01:34:54.8901405Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.8902134Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.8902898Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.8903731Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.8904513Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.8905286Z     self.dialect.do_execute(
2025-09-30T01:34:54.8905971Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.8906715Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.8907520Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.8908318Z     self._adapt_connection.await_(
2025-09-30T01:34:54.8909049Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.8910395Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.8911089Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8911861Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.8912603Z     value = await result
2025-09-30T01:34:54.8912877Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.8913612Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.8914462Z     self._handle_exception(error)
2025-09-30T01:34:54.8915286Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.8916164Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.8917062Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.8917869Z     raise error
2025-09-30T01:34:54.8918668Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.8919770Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.8920684Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.8921506Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.8922204Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.8922884Z     return await self._prepare(
2025-09-30T01:34:54.8923508Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.8924190Z     stmt = await self._get_statement(
2025-09-30T01:34:54.8924831Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.8925558Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.8925962Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.8926408Z     ???
2025-09-30T01:34:54.8928547Z E   RuntimeError: Task <Task pending name='Task-20' coro=<TestCriticalUserJourneys.test_room_closure_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_critical_workflows.py:95> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.8931087Z ____________ TestCriticalUserJourneys.test_authentication_security _____________
2025-09-30T01:34:54.8931885Z tests/e2e/test_critical_workflows.py:146: in test_authentication_security
2025-09-30T01:34:54.8932641Z     register_response = await async_client.post("/api/v1/auth/register", json=sample_user_data)
2025-09-30T01:34:54.8933229Z                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8933911Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1859: in post
2025-09-30T01:34:54.8934544Z     return await self.request(
2025-09-30T01:34:54.8935156Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.8935967Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.8936492Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8937154Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.8937981Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.8938679Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.8939673Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.8940420Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.8941219Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.8941632Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8942343Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.8943170Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.8943601Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8944365Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.8945138Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.8945843Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.8946564Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.8947252Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.8948021Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.8948803Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.8949642Z     raise exc
2025-09-30T01:34:54.8950253Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.8951017Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.8951779Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.8952704Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.8953617Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.8954327Z     raise exc
2025-09-30T01:34:54.8954992Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.8955798Z     await app(scope, receive, sender)
2025-09-30T01:34:54.8956501Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.8957237Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.8957913Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.8958605Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.8959398Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.8960092Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.8960778Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.8961572Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.8962470Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.8963255Z     raise exc
2025-09-30T01:34:54.8963897Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.8964649Z     await app(scope, receive, sender)
2025-09-30T01:34:54.8965294Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.8965962Z     response = await f(request)
2025-09-30T01:34:54.8966439Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.8967073Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.8967829Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.8968589Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.8969466Z     return await dependant.call(**values)
2025-09-30T01:34:54.8969812Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9004950Z app/api/v1/endpoints/auth_router.py:28: in register_user
2025-09-30T01:34:54.9005537Z     if await user_repo.email_exists(user_data.email):
2025-09-30T01:34:54.9006179Z        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9006622Z app/repositories/user_repository.py:120: in email_exists
2025-09-30T01:34:54.9007113Z     user = await self.get_by_email(email)
2025-09-30T01:34:54.9007533Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9007924Z app/repositories/user_repository.py:64: in get_by_email
2025-09-30T01:34:54.9008358Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9008679Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9009604Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9010290Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9011036Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9011825Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9012160Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9012789Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9013472Z     return self._execute_internal(
2025-09-30T01:34:54.9014245Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2241: in _execute_internal
2025-09-30T01:34:54.9015041Z     conn = self._connection_for_bind(bind)
2025-09-30T01:34:54.9015428Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9016168Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2110: in _connection_for_bind
2025-09-30T01:34:54.9017051Z     return trans._connection_for_bind(engine, execution_options)
2025-09-30T01:34:54.9017503Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9017855Z <string>:2: in _connection_for_bind
2025-09-30T01:34:54.9018146Z     ???
2025-09-30T01:34:54.9018695Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9019537Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9019872Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9020620Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1189: in _connection_for_bind
2025-09-30T01:34:54.9022055Z     conn = bind.connect()
2025-09-30T01:34:54.9022566Z            ^^^^^^^^^^^^^^
2025-09-30T01:34:54.9023647Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T01:34:54.9024942Z     return self._connection_cls(self)
2025-09-30T01:34:54.9025452Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9026722Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.9028104Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.9028831Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9030240Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.9031582Z     return self.pool.connect()
2025-09-30T01:34:54.9032082Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9033403Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.9034589Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.9035329Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9036448Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.9037573Z     with util.safe_reraise():
2025-09-30T01:34:54.9038024Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9039324Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.9040597Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.9041732Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.9042934Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.9044264Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.9045598Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.9046207Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9047380Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.9048682Z     dbapi_connection.ping()
2025-09-30T01:34:54.9050037Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.9051347Z     self._handle_exception(error)
2025-09-30T01:34:54.9052754Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9054337Z     raise error
2025-09-30T01:34:54.9055475Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T01:34:54.9056748Z     _ = self.await_(self._async_ping())
2025-09-30T01:34:54.9057288Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9058594Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9060712Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9061780Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9063406Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9064485Z     value = await result
2025-09-30T01:34:54.9064633Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9065393Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T01:34:54.9065562Z     await tr.start()
2025-09-30T01:34:54.9066151Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T01:34:54.9066363Z     await self._connection.execute(query)
2025-09-30T01:34:54.9066948Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T01:34:54.9067223Z     result = await self._protocol.query(query, timeout)
2025-09-30T01:34:54.9067364Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9067537Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T01:34:54.9067683Z     ???
2025-09-30T01:34:54.9070748Z E   RuntimeError: Task <Task pending name='Task-28' coro=<TestCriticalUserJourneys.test_authentication_security() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_critical_workflows.py:146> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9071211Z ------------------------------ Captured log call -------------------------------
2025-09-30T01:34:54.9072444Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7ff8191c8b90>>
2025-09-30T01:34:54.9072636Z Traceback (most recent call last):
2025-09-30T01:34:54.9082906Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T01:34:54.9083160Z     self._dialect.do_terminate(connection)
2025-09-30T01:34:54.9083315Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T01:34:54.9084271Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T01:34:54.9084456Z     dbapi_connection.terminate()
2025-09-30T01:34:54.9084616Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T01:34:54.9085542Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T01:34:54.9085900Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T01:34:54.9086085Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9086973Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T01:34:54.9087437Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9087585Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T01:34:54.9088523Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T01:34:54.9088671Z     value = await result
2025-09-30T01:34:54.9088819Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9089764Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T01:34:54.9089952Z     await self._protocol.close(timeout)
2025-09-30T01:34:54.9090295Z   File "asyncpg/protocol/protocol.pyx", line 628, in close
2025-09-30T01:34:54.9092625Z RuntimeError: Task <Task pending name='Task-29' coro=<Connection.close() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:1504> cb=[shield.<locals>._inner_done_callback() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/tasks.py:958]> got Future <Future pending> attached to a different loop
2025-09-30T01:34:54.9092884Z ---------------------------- Captured log teardown -----------------------------
2025-09-30T01:34:54.9093171Z ERROR    asyncio:base_events.py:1879 Future exception was never retrieved
2025-09-30T01:34:54.9093632Z future: <Future finished exception=InternalClientError('got result for unknown protocol state 3')>
2025-09-30T01:34:54.9093838Z Traceback (most recent call last):
2025-09-30T01:34:54.9094565Z   File "asyncpg/protocol/protocol.pyx", line 903, in asyncpg.protocol.protocol.BaseProtocol._dispatch_result
2025-09-30T01:34:54.9095075Z asyncpg.exceptions._base.InternalClientError: got result for unknown protocol state 3
2025-09-30T01:34:54.9095487Z _____________ TestDatabaseConstraints.test_message_xor_constraint ______________
2025-09-30T01:34:54.9096191Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:876: in rollback
2025-09-30T01:34:54.9096409Z     self.await_(self._rollback_and_discard())
2025-09-30T01:34:54.9097114Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9097748Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9097912Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9098857Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9099018Z     value = await result
2025-09-30T01:34:54.9099390Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9100287Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:857: in _rollback_and_discard
2025-09-30T01:34:54.9100487Z     await self._transaction.rollback()
2025-09-30T01:34:54.9101164Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:227: in rollback
2025-09-30T01:34:54.9101329Z     await self.__rollback()
2025-09-30T01:34:54.9101907Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:206: in __rollback
2025-09-30T01:34:54.9102141Z     await self._connection.execute(query)
2025-09-30T01:34:54.9102748Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T01:34:54.9102991Z     result = await self._protocol.query(query, timeout)
2025-09-30T01:34:54.9103166Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9103392Z asyncpg/protocol/protocol.pyx:360: in query
2025-09-30T01:34:54.9103542Z     ???
2025-09-30T01:34:54.9104097Z asyncpg/protocol/protocol.pyx:745: in asyncpg.protocol.protocol.BaseProtocol._check_state
2025-09-30T01:34:54.9104226Z     ???
2025-09-30T01:34:54.9104937Z E   asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9104956Z 
2025-09-30T01:34:54.9105342Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.9106379Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1124: in _rollback_impl
2025-09-30T01:34:54.9106678Z     self.engine.dialect.do_rollback(self.connection)
2025-09-30T01:34:54.9107552Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:703: in do_rollback
2025-09-30T01:34:54.9107822Z     dbapi_connection.rollback()
2025-09-30T01:34:54.9108920Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:882: in rollback
2025-09-30T01:34:54.9109292Z     self._handle_exception(error)
2025-09-30T01:34:54.9110789Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.9111077Z     raise translated_error from error
2025-09-30T01:34:54.9113164Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9113178Z 
2025-09-30T01:34:54.9113731Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.9114357Z tests/e2e/test_database_constraints.py:30: in test_message_xor_constraint
2025-09-30T01:34:54.9114649Z     await async_db_session.commit()
2025-09-30T01:34:54.9115801Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.9116163Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.9117452Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9117740Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9117974Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9118997Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.9119405Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.9119652Z <string>:2: in commit
2025-09-30T01:34:54.9119864Z     ???
2025-09-30T01:34:54.9120922Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9121361Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9121582Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9122703Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1313: in commit
2025-09-30T01:34:54.9122968Z     self._prepare_impl()
2025-09-30T01:34:54.9123225Z <string>:2: in _prepare_impl
2025-09-30T01:34:54.9123433Z     ???
2025-09-30T01:34:54.9124486Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9124744Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9124961Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9126136Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
2025-09-30T01:34:54.9126389Z     self.session.flush()
2025-09-30T01:34:54.9127395Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4345: in flush
2025-09-30T01:34:54.9127646Z     self._flush(objects)
2025-09-30T01:34:54.9128659Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4480: in _flush
2025-09-30T01:34:54.9128917Z     with util.safe_reraise():
2025-09-30T01:34:54.9129265Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9130381Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:228: in __exit__
2025-09-30T01:34:54.9130673Z     raise value.with_traceback(traceback)
2025-09-30T01:34:54.9131703Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4481: in _flush
2025-09-30T01:34:54.9132051Z     transaction.rollback(_capture_exception=True)
2025-09-30T01:34:54.9132285Z <string>:2: in rollback
2025-09-30T01:34:54.9132502Z     ???
2025-09-30T01:34:54.9133508Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9133762Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9133999Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9135047Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1395: in rollback
2025-09-30T01:34:54.9135444Z     raise rollback_err[1].with_traceback(rollback_err[2])
2025-09-30T01:34:54.9136510Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1360: in rollback
2025-09-30T01:34:54.9136733Z     t[1].rollback()
2025-09-30T01:34:54.9137765Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2607: in rollback
2025-09-30T01:34:54.9138007Z     self._do_rollback()
2025-09-30T01:34:54.9139441Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2726: in _do_rollback
2025-09-30T01:34:54.9139730Z     self._close_impl(try_deactivate=True)
2025-09-30T01:34:54.9140844Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2709: in _close_impl
2025-09-30T01:34:54.9141129Z     self._connection_rollback_impl()
2025-09-30T01:34:54.9142442Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2701: in _connection_rollback_impl
2025-09-30T01:34:54.9142653Z     self.connection._rollback_impl()
2025-09-30T01:34:54.9143418Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1126: in _rollback_impl
2025-09-30T01:34:54.9143726Z     self._handle_dbapi_exception(e, None, None, None, None)
2025-09-30T01:34:54.9144677Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
2025-09-30T01:34:54.9145056Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.9145905Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1124: in _rollback_impl
2025-09-30T01:34:54.9146208Z     self.engine.dialect.do_rollback(self.connection)
2025-09-30T01:34:54.9147231Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:703: in do_rollback
2025-09-30T01:34:54.9147537Z     dbapi_connection.rollback()
2025-09-30T01:34:54.9148524Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:882: in rollback
2025-09-30T01:34:54.9148733Z     self._handle_exception(error)
2025-09-30T01:34:54.9149961Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.9150179Z     raise translated_error from error
2025-09-30T01:34:54.9151848Z E   sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9152252Z E   (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9152769Z _____________ TestDatabaseConstraints.test_foreign_key_constraints _____________
2025-09-30T01:34:54.9153256Z tests/e2e/test_database_constraints.py:112: in test_foreign_key_constraints
2025-09-30T01:34:54.9153478Z     await async_db_session.commit()
2025-09-30T01:34:54.9154379Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.9154637Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.9155616Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9155838Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9156013Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9156816Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.9157015Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.9157198Z <string>:2: in commit
2025-09-30T01:34:54.9157377Z     ???
2025-09-30T01:34:54.9158201Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9158406Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9158584Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9159512Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1320: in commit
2025-09-30T01:34:54.9159696Z     trans.commit()
2025-09-30T01:34:54.9160477Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2628: in commit
2025-09-30T01:34:54.9160659Z     self._do_commit()
2025-09-30T01:34:54.9161484Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2733: in _do_commit
2025-09-30T01:34:54.9161706Z     self._connection_commit_impl()
2025-09-30T01:34:54.9162780Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2704: in _connection_commit_impl
2025-09-30T01:34:54.9163008Z     self.connection._commit_impl()
2025-09-30T01:34:54.9163929Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1143: in _commit_impl
2025-09-30T01:34:54.9164248Z     self._handle_dbapi_exception(e, None, None, None, None)
2025-09-30T01:34:54.9165230Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9165499Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9166395Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1141: in _commit_impl
2025-09-30T01:34:54.9166684Z     self.engine.dialect.do_commit(self.connection)
2025-09-30T01:34:54.9167516Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:706: in do_commit
2025-09-30T01:34:54.9167626Z     dbapi_connection.commit()
2025-09-30T01:34:54.9168351Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:893: in commit
2025-09-30T01:34:54.9168474Z     self._handle_exception(error)
2025-09-30T01:34:54.9169349Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9169463Z     raise error
2025-09-30T01:34:54.9170004Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:887: in commit
2025-09-30T01:34:54.9170142Z     self.await_(self._commit_and_discard())
2025-09-30T01:34:54.9170678Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9171070Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9171172Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9171753Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9171881Z     value = await result
2025-09-30T01:34:54.9171984Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9172599Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:866: in _commit_and_discard
2025-09-30T01:34:54.9172730Z     await self._transaction.commit()
2025-09-30T01:34:54.9173143Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:219: in commit
2025-09-30T01:34:54.9173252Z     await self.__commit()
2025-09-30T01:34:54.9173673Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:187: in __commit
2025-09-30T01:34:54.9173814Z     await self._connection.execute(query)
2025-09-30T01:34:54.9174287Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T01:34:54.9174467Z     result = await self._protocol.query(query, timeout)
2025-09-30T01:34:54.9174593Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9174752Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T01:34:54.9174852Z     ???
2025-09-30T01:34:54.9176745Z E   RuntimeError: Task <Task pending name='Task-53' coro=<TestDatabaseConstraints.test_foreign_key_constraints() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_database_constraints.py:112> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9177075Z ______ TestDatabaseConstraints.test_conversation_participant_constraints _______
2025-09-30T01:34:54.9177613Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:876: in rollback
2025-09-30T01:34:54.9177773Z     self.await_(self._rollback_and_discard())
2025-09-30T01:34:54.9178287Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9178656Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9178770Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9179463Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9179579Z     value = await result
2025-09-30T01:34:54.9179688Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9180338Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:857: in _rollback_and_discard
2025-09-30T01:34:54.9180477Z     await self._transaction.rollback()
2025-09-30T01:34:54.9180898Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:227: in rollback
2025-09-30T01:34:54.9181156Z     await self.__rollback()
2025-09-30T01:34:54.9181599Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:206: in __rollback
2025-09-30T01:34:54.9181825Z     await self._connection.execute(query)
2025-09-30T01:34:54.9182258Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T01:34:54.9182426Z     result = await self._protocol.query(query, timeout)
2025-09-30T01:34:54.9182549Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9182681Z asyncpg/protocol/protocol.pyx:360: in query
2025-09-30T01:34:54.9182774Z     ???
2025-09-30T01:34:54.9183164Z asyncpg/protocol/protocol.pyx:745: in asyncpg.protocol.protocol.BaseProtocol._check_state
2025-09-30T01:34:54.9183253Z     ???
2025-09-30T01:34:54.9183663Z E   asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9183675Z 
2025-09-30T01:34:54.9183935Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.9184440Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1124: in _rollback_impl
2025-09-30T01:34:54.9184615Z     self.engine.dialect.do_rollback(self.connection)
2025-09-30T01:34:54.9185118Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:703: in do_rollback
2025-09-30T01:34:54.9185251Z     dbapi_connection.rollback()
2025-09-30T01:34:54.9185808Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:882: in rollback
2025-09-30T01:34:54.9185926Z     self._handle_exception(error)
2025-09-30T01:34:54.9186511Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.9186657Z     raise translated_error from error
2025-09-30T01:34:54.9187491Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9187509Z 
2025-09-30T01:34:54.9187767Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.9188114Z tests/e2e/test_database_constraints.py:149: in test_conversation_participant_constraints
2025-09-30T01:34:54.9188250Z     await async_db_session.commit()
2025-09-30T01:34:54.9188755Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.9188936Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.9189631Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9189777Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9189894Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9190344Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.9190474Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.9190596Z <string>:2: in commit
2025-09-30T01:34:54.9190688Z     ???
2025-09-30T01:34:54.9191130Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9191259Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9191357Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9191809Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1313: in commit
2025-09-30T01:34:54.9191929Z     self._prepare_impl()
2025-09-30T01:34:54.9192051Z <string>:2: in _prepare_impl
2025-09-30T01:34:54.9192140Z     ???
2025-09-30T01:34:54.9192590Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9192710Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9192969Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9193538Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
2025-09-30T01:34:54.9193660Z     self.session.flush()
2025-09-30T01:34:54.9194098Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4345: in flush
2025-09-30T01:34:54.9194215Z     self._flush(objects)
2025-09-30T01:34:54.9194667Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4480: in _flush
2025-09-30T01:34:54.9194790Z     with util.safe_reraise():
2025-09-30T01:34:54.9194893Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9195372Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:228: in __exit__
2025-09-30T01:34:54.9195510Z     raise value.with_traceback(traceback)
2025-09-30T01:34:54.9195956Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4481: in _flush
2025-09-30T01:34:54.9196122Z     transaction.rollback(_capture_exception=True)
2025-09-30T01:34:54.9196217Z <string>:2: in rollback
2025-09-30T01:34:54.9196312Z     ???
2025-09-30T01:34:54.9196750Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9196864Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9196978Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9197381Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1395: in rollback
2025-09-30T01:34:54.9197549Z     raise rollback_err[1].with_traceback(rollback_err[2])
2025-09-30T01:34:54.9197968Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1360: in rollback
2025-09-30T01:34:54.9198062Z     t[1].rollback()
2025-09-30T01:34:54.9198507Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2607: in rollback
2025-09-30T01:34:54.9198638Z     self._do_rollback()
2025-09-30T01:34:54.9199263Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2726: in _do_rollback
2025-09-30T01:34:54.9199410Z     self._close_impl(try_deactivate=True)
2025-09-30T01:34:54.9199876Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2709: in _close_impl
2025-09-30T01:34:54.9200000Z     self._connection_rollback_impl()
2025-09-30T01:34:54.9200559Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2701: in _connection_rollback_impl
2025-09-30T01:34:54.9200686Z     self.connection._rollback_impl()
2025-09-30T01:34:54.9201171Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1126: in _rollback_impl
2025-09-30T01:34:54.9201357Z     self._handle_dbapi_exception(e, None, None, None, None)
2025-09-30T01:34:54.9201915Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
2025-09-30T01:34:54.9202153Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.9202664Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1124: in _rollback_impl
2025-09-30T01:34:54.9202842Z     self.engine.dialect.do_rollback(self.connection)
2025-09-30T01:34:54.9203312Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:703: in do_rollback
2025-09-30T01:34:54.9203455Z     dbapi_connection.rollback()
2025-09-30T01:34:54.9204028Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:882: in rollback
2025-09-30T01:34:54.9204157Z     self._handle_exception(error)
2025-09-30T01:34:54.9204741Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.9205014Z     raise translated_error from error
2025-09-30T01:34:54.9206023Z E   sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9206274Z E   (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9206537Z ______________ TestDatabaseConstraints.test_nullable_constraints _______________
2025-09-30T01:34:54.9207069Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:876: in rollback
2025-09-30T01:34:54.9207229Z     self.await_(self._rollback_and_discard())
2025-09-30T01:34:54.9207699Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9208078Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9208199Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9208731Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9208870Z     value = await result
2025-09-30T01:34:54.9208980Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9209730Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:857: in _rollback_and_discard
2025-09-30T01:34:54.9209885Z     await self._transaction.rollback()
2025-09-30T01:34:54.9210317Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:227: in rollback
2025-09-30T01:34:54.9210426Z     await self.__rollback()
2025-09-30T01:34:54.9210913Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:206: in __rollback
2025-09-30T01:34:54.9211045Z     await self._connection.execute(query)
2025-09-30T01:34:54.9211433Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T01:34:54.9211621Z     result = await self._protocol.query(query, timeout)
2025-09-30T01:34:54.9211744Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9211894Z asyncpg/protocol/protocol.pyx:360: in query
2025-09-30T01:34:54.9211998Z     ???
2025-09-30T01:34:54.9212363Z asyncpg/protocol/protocol.pyx:745: in asyncpg.protocol.protocol.BaseProtocol._check_state
2025-09-30T01:34:54.9212468Z     ???
2025-09-30T01:34:54.9212862Z E   asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9212872Z 
2025-09-30T01:34:54.9213126Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.9213647Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1124: in _rollback_impl
2025-09-30T01:34:54.9213858Z     self.engine.dialect.do_rollback(self.connection)
2025-09-30T01:34:54.9214386Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:703: in do_rollback
2025-09-30T01:34:54.9214511Z     dbapi_connection.rollback()
2025-09-30T01:34:54.9215069Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:882: in rollback
2025-09-30T01:34:54.9215188Z     self._handle_exception(error)
2025-09-30T01:34:54.9215803Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.9215935Z     raise translated_error from error
2025-09-30T01:34:54.9216808Z E   sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9216819Z 
2025-09-30T01:34:54.9217085Z The above exception was the direct cause of the following exception:
2025-09-30T01:34:54.9217357Z tests/e2e/test_database_constraints.py:193: in test_nullable_constraints
2025-09-30T01:34:54.9217691Z     await async_db_session.commit()
2025-09-30T01:34:54.9218300Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:1014: in commit
2025-09-30T01:34:54.9218476Z     await greenlet_spawn(self.sync_session.commit)
2025-09-30T01:34:54.9219024Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9219291Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9219410Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9219846Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2032: in commit
2025-09-30T01:34:54.9219979Z     trans.commit(_to_root=True)
2025-09-30T01:34:54.9220078Z <string>:2: in commit
2025-09-30T01:34:54.9220169Z     ???
2025-09-30T01:34:54.9220627Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9220760Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9220862Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9221288Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1313: in commit
2025-09-30T01:34:54.9221403Z     self._prepare_impl()
2025-09-30T01:34:54.9221522Z <string>:2: in _prepare_impl
2025-09-30T01:34:54.9221615Z     ???
2025-09-30T01:34:54.9222058Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9222178Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9222283Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9222769Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1288: in _prepare_impl
2025-09-30T01:34:54.9222878Z     self.session.flush()
2025-09-30T01:34:54.9223342Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4345: in flush
2025-09-30T01:34:54.9223462Z     self._flush(objects)
2025-09-30T01:34:54.9223917Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4480: in _flush
2025-09-30T01:34:54.9224047Z     with util.safe_reraise():
2025-09-30T01:34:54.9224150Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9224638Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:228: in __exit__
2025-09-30T01:34:54.9224781Z     raise value.with_traceback(traceback)
2025-09-30T01:34:54.9225229Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:4481: in _flush
2025-09-30T01:34:54.9225397Z     transaction.rollback(_capture_exception=True)
2025-09-30T01:34:54.9225514Z <string>:2: in rollback
2025-09-30T01:34:54.9225598Z     ???
2025-09-30T01:34:54.9226111Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9226242Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9226338Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9226803Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1395: in rollback
2025-09-30T01:34:54.9226990Z     raise rollback_err[1].with_traceback(rollback_err[2])
2025-09-30T01:34:54.9227442Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1360: in rollback
2025-09-30T01:34:54.9227531Z     t[1].rollback()
2025-09-30T01:34:54.9227996Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2607: in rollback
2025-09-30T01:34:54.9228100Z     self._do_rollback()
2025-09-30T01:34:54.9228601Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2726: in _do_rollback
2025-09-30T01:34:54.9228752Z     self._close_impl(try_deactivate=True)
2025-09-30T01:34:54.9229333Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2709: in _close_impl
2025-09-30T01:34:54.9229608Z     self._connection_rollback_impl()
2025-09-30T01:34:54.9230247Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2701: in _connection_rollback_impl
2025-09-30T01:34:54.9230374Z     self.connection._rollback_impl()
2025-09-30T01:34:54.9230869Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1126: in _rollback_impl
2025-09-30T01:34:54.9231089Z     self._handle_dbapi_exception(e, None, None, None, None)
2025-09-30T01:34:54.9231659Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2351: in _handle_dbapi_exception
2025-09-30T01:34:54.9231893Z     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
2025-09-30T01:34:54.9232420Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1124: in _rollback_impl
2025-09-30T01:34:54.9232611Z     self.engine.dialect.do_rollback(self.connection)
2025-09-30T01:34:54.9233136Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:703: in do_rollback
2025-09-30T01:34:54.9233264Z     dbapi_connection.rollback()
2025-09-30T01:34:54.9233846Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:882: in rollback
2025-09-30T01:34:54.9233993Z     self._handle_exception(error)
2025-09-30T01:34:54.9234656Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:792: in _handle_exception
2025-09-30T01:34:54.9234798Z     raise translated_error from error
2025-09-30T01:34:54.9235816Z E   sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9236052Z E   (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9236354Z _____________ TestDatabaseConstraints.test_database_indexes_exist ______________
2025-09-30T01:34:54.9236650Z tests/e2e/test_database_constraints.py:280: in test_database_indexes_exist
2025-09-30T01:34:54.9236825Z     result = await async_db_session.execute(text(sql))
2025-09-30T01:34:54.9236943Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9237420Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9237543Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9238119Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9238279Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9238410Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9238836Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9238995Z     return self._execute_internal(
2025-09-30T01:34:54.9239649Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2241: in _execute_internal
2025-09-30T01:34:54.9239788Z     conn = self._connection_for_bind(bind)
2025-09-30T01:34:54.9239920Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9240484Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2110: in _connection_for_bind
2025-09-30T01:34:54.9240727Z     return trans._connection_for_bind(engine, execution_options)
2025-09-30T01:34:54.9240875Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9241003Z <string>:2: in _connection_for_bind
2025-09-30T01:34:54.9241107Z     ???
2025-09-30T01:34:54.9241580Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py:139: in _go
2025-09-30T01:34:54.9241852Z     ret_value = fn(self, *arg, **kw)
2025-09-30T01:34:54.9241957Z                 ^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9242571Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:1189: in _connection_for_bind
2025-09-30T01:34:54.9242700Z     conn = bind.connect()
2025-09-30T01:34:54.9242821Z            ^^^^^^^^^^^^^^
2025-09-30T01:34:54.9243287Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3273: in connect
2025-09-30T01:34:54.9243422Z     return self._connection_cls(self)
2025-09-30T01:34:54.9243539Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9244022Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:145: in __init__
2025-09-30T01:34:54.9244200Z     self._dbapi_connection = engine.raw_connection()
2025-09-30T01:34:54.9244328Z                              ^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9244836Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:3297: in raw_connection
2025-09-30T01:34:54.9244975Z     return self.pool.connect()
2025-09-30T01:34:54.9245093Z            ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9245534Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:449: in connect
2025-09-30T01:34:54.9245679Z     return _ConnectionFairy._checkout(self)
2025-09-30T01:34:54.9245794Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9246248Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1363: in _checkout
2025-09-30T01:34:54.9246367Z     with util.safe_reraise():
2025-09-30T01:34:54.9246482Z          ^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9246979Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
2025-09-30T01:34:54.9247116Z     raise exc_value.with_traceback(exc_tb)
2025-09-30T01:34:54.9247565Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py:1301: in _checkout
2025-09-30T01:34:54.9247708Z     result = pool._dialect._do_ping_w_event(
2025-09-30T01:34:54.9248237Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:720: in _do_ping_w_event
2025-09-30T01:34:54.9248379Z     return self.do_ping(dbapi_connection)
2025-09-30T01:34:54.9248490Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9249059Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:1163: in do_ping
2025-09-30T01:34:54.9249326Z     dbapi_connection.ping()
2025-09-30T01:34:54.9249876Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:813: in ping
2025-09-30T01:34:54.9250008Z     self._handle_exception(error)
2025-09-30T01:34:54.9250642Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9250744Z     raise error
2025-09-30T01:34:54.9251247Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:811: in ping
2025-09-30T01:34:54.9251393Z     _ = self.await_(self._async_ping())
2025-09-30T01:34:54.9251493Z         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9251993Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9252395Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9252499Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9253096Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9253213Z     value = await result
2025-09-30T01:34:54.9253324Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9253970Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:820: in _async_ping
2025-09-30T01:34:54.9254248Z     await tr.start()
2025-09-30T01:34:54.9254816Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/transaction.py:146: in start
2025-09-30T01:34:54.9254967Z     await self._connection.execute(query)
2025-09-30T01:34:54.9255406Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
2025-09-30T01:34:54.9255586Z     result = await self._protocol.query(query, timeout)
2025-09-30T01:34:54.9255728Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9255882Z asyncpg/protocol/protocol.pyx:375: in query
2025-09-30T01:34:54.9255968Z     ???
2025-09-30T01:34:54.9257973Z E   RuntimeError: Task <Task pending name='Task-87' coro=<TestDatabaseConstraints.test_database_indexes_exist() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_database_constraints.py:280> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9258252Z ------------------------------ Captured log call -------------------------------
2025-09-30T01:34:54.9259283Z ERROR    sqlalchemy.pool.impl.AsyncAdaptedQueuePool:base.py:378 Exception terminating connection <AdaptedConnection <asyncpg.connection.Connection object at 0x7ff8157cd130>>
2025-09-30T01:34:54.9259442Z Traceback (most recent call last):
2025-09-30T01:34:54.9260234Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 374, in _close_connection
2025-09-30T01:34:54.9260397Z     self._dialect.do_terminate(connection)
2025-09-30T01:34:54.9260513Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
2025-09-30T01:34:54.9261179Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 1130, in do_terminate
2025-09-30T01:34:54.9261344Z     dbapi_connection.terminate()
2025-09-30T01:34:54.9261445Z     ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
2025-09-30T01:34:54.9262073Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 907, in terminate
2025-09-30T01:34:54.9262297Z     self.await_(asyncio.shield(self._connection.close(timeout=2)))
2025-09-30T01:34:54.9262428Z     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9263011Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
2025-09-30T01:34:54.9263383Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9263494Z            ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
2025-09-30T01:34:54.9264117Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
2025-09-30T01:34:54.9264241Z     value = await result
2025-09-30T01:34:54.9264350Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9264905Z   File "/opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py", line 1504, in close
2025-09-30T01:34:54.9265055Z     await self._protocol.close(timeout)
2025-09-30T01:34:54.9265327Z   File "asyncpg/protocol/protocol.pyx", line 628, in close
2025-09-30T01:34:54.9266924Z RuntimeError: Task <Task pending name='Task-88' coro=<Connection.close() running at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:1504> cb=[shield.<locals>._inner_done_callback() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/tasks.py:958]> got Future <Future pending> attached to a different loop
2025-09-30T01:34:54.9267185Z ---------------------------- Captured log teardown -----------------------------
2025-09-30T01:34:54.9267464Z ERROR    asyncio:base_events.py:1879 Future exception was never retrieved
2025-09-30T01:34:54.9268054Z future: <Future finished exception=InternalClientError('got result for unknown protocol state 3')>
2025-09-30T01:34:54.9268300Z Traceback (most recent call last):
2025-09-30T01:34:54.9268875Z   File "asyncpg/protocol/protocol.pyx", line 903, in asyncpg.protocol.protocol.BaseProtocol._dispatch_result
2025-09-30T01:34:54.9269405Z asyncpg.exceptions._base.InternalClientError: got result for unknown protocol state 3
2025-09-30T01:34:54.9269694Z _________________ TestIntegrationAPI.test_room_count_endpoint __________________
2025-09-30T01:34:54.9269924Z tests/e2e/test_integration_api.py:83: in test_room_count_endpoint
2025-09-30T01:34:54.9270142Z     response = await authenticated_client.get("/api/v1/rooms/count")
2025-09-30T01:34:54.9270273Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9270672Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1768: in get
2025-09-30T01:34:54.9270804Z     return await self.request(
2025-09-30T01:34:54.9271198Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.9271493Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.9271625Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9272025Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.9272186Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.9272654Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.9272812Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.9273323Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.9273516Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.9273639Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9274104Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.9274309Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.9274437Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9274943Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.9275098Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9275589Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.9275751Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.9276235Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.9276426Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9276948Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.9277059Z     raise exc
2025-09-30T01:34:54.9277553Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.9277686Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.9278210Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.9278491Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.9279060Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9279304Z     raise exc
2025-09-30T01:34:54.9279757Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9280030Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9280498Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.9280685Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9281116Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.9281246Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.9281615Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.9281742Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9282099Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.9282352Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.9282855Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9282954Z     raise exc
2025-09-30T01:34:54.9283408Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9283534Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9283918Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.9284038Z     response = await f(request)
2025-09-30T01:34:54.9284142Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9284525Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.9284683Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.9285201Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.9285340Z     return await dependant.call(**values)
2025-09-30T01:34:54.9285452Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9285684Z app/api/v1/endpoints/room_router.py:107: in get_room_count
2025-09-30T01:34:54.9285844Z     return await room_service.get_room_count()
2025-09-30T01:34:54.9285955Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9286139Z app/services/room_service.py:142: in get_room_count
2025-09-30T01:34:54.9286341Z     active_rooms = await self.room_repo.get_active_rooms()
2025-09-30T01:34:54.9286450Z                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9286682Z app/repositories/room_repository.py:64: in get_active_rooms
2025-09-30T01:34:54.9286817Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9286922Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9287430Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9287563Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9288131Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9288284Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9288386Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9288781Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9288908Z     return self._execute_internal(
2025-09-30T01:34:54.9289542Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.9289772Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.9290324Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.9290444Z     result = conn.execute(
2025-09-30T01:34:54.9290888Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.9291163Z     return meth(
2025-09-30T01:34:54.9291817Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.9291986Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.9292564Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.9292686Z     ret = self._execute_context(
2025-09-30T01:34:54.9293210Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.9293330Z     return self._exec_single_context(
2025-09-30T01:34:54.9293856Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.9293994Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.9294563Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9294710Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9295276Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.9295407Z     self.dialect.do_execute(
2025-09-30T01:34:54.9295891Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.9296031Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.9296577Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.9296697Z     self._adapt_connection.await_(
2025-09-30T01:34:54.9297220Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9297622Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9297739Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9298332Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9298450Z     value = await result
2025-09-30T01:34:54.9298552Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9299388Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.9299519Z     self._handle_exception(error)
2025-09-30T01:34:54.9300104Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.9300289Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.9300881Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9300982Z     raise error
2025-09-30T01:34:54.9301591Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.9301821Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.9302381Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.9302538Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.9302948Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.9303074Z     return await self._prepare(
2025-09-30T01:34:54.9303506Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.9303626Z     stmt = await self._get_statement(
2025-09-30T01:34:54.9304286Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.9304433Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.9304685Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.9304793Z     ???
2025-09-30T01:34:54.9306705Z E   RuntimeError: Task <Task pending name='Task-106' coro=<TestIntegrationAPI.test_room_count_endpoint() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:83> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9306940Z ---------------------------- Captured stdout setup -----------------------------
2025-09-30T01:34:54.9307402Z ✅ Created integration test user with ID: 1
2025-09-30T01:34:54.9307674Z ________________ TestIntegrationAPI.test_get_all_rooms_endpoint ________________
2025-09-30T01:34:54.9307939Z tests/e2e/test_integration_api.py:93: in test_get_all_rooms_endpoint
2025-09-30T01:34:54.9308186Z     response = await authenticated_client.get("/api/v1/rooms/")
2025-09-30T01:34:54.9308308Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9308712Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1768: in get
2025-09-30T01:34:54.9308844Z     return await self.request(
2025-09-30T01:34:54.9309375Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.9309671Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.9309809Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9310202Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.9310376Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.9310826Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.9310988Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.9311472Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.9311634Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.9311746Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9312206Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.9312397Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.9312515Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9313045Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.9313185Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9313696Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.9313852Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.9314308Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.9314496Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9314998Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.9315100Z     raise exc
2025-09-30T01:34:54.9315590Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.9315729Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.9316215Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.9316711Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.9317305Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9317410Z     raise exc
2025-09-30T01:34:54.9317917Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9318042Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9318473Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.9318642Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9319031Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.9319300Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.9319736Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.9319873Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9320278Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.9320554Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.9321041Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9321135Z     raise exc
2025-09-30T01:34:54.9321638Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9321763Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9322154Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.9322265Z     response = await f(request)
2025-09-30T01:34:54.9322378Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9322770Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.9322927Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.9323375Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.9323508Z     return await dependant.call(**values)
2025-09-30T01:34:54.9323610Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9323805Z app/api/v1/endpoints/room_router.py:32: in get_all_rooms
2025-09-30T01:34:54.9323945Z     return await room_service.get_all_rooms()
2025-09-30T01:34:54.9324044Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9324201Z app/services/room_service.py:41: in get_all_rooms
2025-09-30T01:34:54.9324359Z     return await self.room_repo.get_active_rooms()
2025-09-30T01:34:54.9324477Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9324715Z app/repositories/room_repository.py:64: in get_active_rooms
2025-09-30T01:34:54.9324852Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9324960Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9325455Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9325582Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9326181Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9326314Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9326439Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9326887Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9327011Z     return self._execute_internal(
2025-09-30T01:34:54.9327521Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.9327888Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.9328522Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.9328663Z     result = conn.execute(
2025-09-30T01:34:54.9329124Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.9329346Z     return meth(
2025-09-30T01:34:54.9329885Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.9330031Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.9330594Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.9330728Z     ret = self._execute_context(
2025-09-30T01:34:54.9331209Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.9331343Z     return self._exec_single_context(
2025-09-30T01:34:54.9331860Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.9331986Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.9332517Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9332680Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9333204Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.9333312Z     self.dialect.do_execute(
2025-09-30T01:34:54.9333787Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.9333935Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.9334463Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.9334580Z     self._adapt_connection.await_(
2025-09-30T01:34:54.9335074Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9335468Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9335579Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9336145Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9336263Z     value = await result
2025-09-30T01:34:54.9336364Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9336991Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.9337133Z     self._handle_exception(error)
2025-09-30T01:34:54.9337745Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.9337918Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.9338503Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9338602Z     raise error
2025-09-30T01:34:54.9339552Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.9339803Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.9340357Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.9340673Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.9341176Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.9341403Z     return await self._prepare(
2025-09-30T01:34:54.9341867Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.9342010Z     stmt = await self._get_statement(
2025-09-30T01:34:54.9342478Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.9342614Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.9342777Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.9342872Z     ???
2025-09-30T01:34:54.9344820Z E   RuntimeError: Task <Task pending name='Task-116' coro=<TestIntegrationAPI.test_get_all_rooms_endpoint() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:93> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9345079Z ---------------------------- Captured stdout setup -----------------------------
2025-09-30T01:34:54.9345396Z ✅ Created integration test user with ID: 1
2025-09-30T01:34:54.9345598Z ✅ Created integration test room with ID: 1
2025-09-30T01:34:54.9345881Z _______________ TestIntegrationAPI.test_get_room_by_id_endpoint ________________
2025-09-30T01:34:54.9346136Z tests/e2e/test_integration_api.py:106: in test_get_room_by_id_endpoint
2025-09-30T01:34:54.9346429Z     response = await authenticated_client.get(f"/api/v1/rooms/{test_room.id}")
2025-09-30T01:34:54.9346563Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9346953Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1768: in get
2025-09-30T01:34:54.9347096Z     return await self.request(
2025-09-30T01:34:54.9347502Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.9347775Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.9347911Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9348281Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.9348438Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.9348907Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.9349063Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.9349668Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.9349865Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.9349983Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9350480Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.9350694Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.9350813Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9351347Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.9351487Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9351949Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.9352114Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.9352583Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.9352898Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9353485Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.9353594Z     raise exc
2025-09-30T01:34:54.9354062Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.9354206Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.9354703Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.9354974Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.9355487Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9355590Z     raise exc
2025-09-30T01:34:54.9356073Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9356217Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9356648Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.9356822Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9357248Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.9357398Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.9357809Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.9357943Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9358342Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.9358596Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.9359104Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9359333Z     raise exc
2025-09-30T01:34:54.9359873Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9360010Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9360431Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.9360567Z     response = await f(request)
2025-09-30T01:34:54.9360674Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9361099Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.9361263Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.9361765Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.9361914Z     return await dependant.call(**values)
2025-09-30T01:34:54.9362036Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9362250Z app/api/v1/endpoints/room_router.py:129: in get_room_by_id
2025-09-30T01:34:54.9362425Z     return await room_service.get_room_by_id(room_id)
2025-09-30T01:34:54.9362546Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9362728Z app/services/room_service.py:138: in get_room_by_id
2025-09-30T01:34:54.9362890Z     return await self._get_room_or_404(room_id)
2025-09-30T01:34:54.9363019Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9363198Z app/services/room_service.py:360: in _get_room_or_404
2025-09-30T01:34:54.9363364Z     room = await self.room_repo.get_by_id(room_id)
2025-09-30T01:34:54.9363491Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9363687Z app/repositories/room_repository.py:58: in get_by_id
2025-09-30T01:34:54.9363830Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9364111Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9364652Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9364866Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9365450Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9365585Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9365703Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9366158Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9366285Z     return self._execute_internal(
2025-09-30T01:34:54.9366777Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.9367007Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.9367572Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.9367701Z     result = conn.execute(
2025-09-30T01:34:54.9368181Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.9368283Z     return meth(
2025-09-30T01:34:54.9368832Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.9368990Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.9369683Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.9369828Z     ret = self._execute_context(
2025-09-30T01:34:54.9370370Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.9370522Z     return self._exec_single_context(
2025-09-30T01:34:54.9371094Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.9371232Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.9371779Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9371938Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9372485Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.9372613Z     self.dialect.do_execute(
2025-09-30T01:34:54.9373131Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.9373273Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.9373865Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.9374014Z     self._adapt_connection.await_(
2025-09-30T01:34:54.9374557Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9374957Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9375084Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9375630Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9375740Z     value = await result
2025-09-30T01:34:54.9375845Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9376478Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.9376596Z     self._handle_exception(error)
2025-09-30T01:34:54.9377232Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.9377539Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.9378226Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9378347Z     raise error
2025-09-30T01:34:54.9378970Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.9379339Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.9379916Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.9380100Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.9380534Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.9380675Z     return await self._prepare(
2025-09-30T01:34:54.9381124Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.9381255Z     stmt = await self._get_statement(
2025-09-30T01:34:54.9381699Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.9381855Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.9382009Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.9382112Z     ???
2025-09-30T01:34:54.9384142Z E   RuntimeError: Task <Task pending name='Task-126' coro=<TestIntegrationAPI.test_get_room_by_id_endpoint() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:106> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9384433Z ---------------------------- Captured stdout setup -----------------------------
2025-09-30T01:34:54.9384742Z ✅ Created integration test user with ID: 1
2025-09-30T01:34:54.9384982Z ✅ Created integration test room with ID: 1
2025-09-30T01:34:54.9385289Z __________________ TestIntegrationAPI.test_join_room_workflow __________________
2025-09-30T01:34:54.9385560Z tests/e2e/test_integration_api.py:118: in test_join_room_workflow
2025-09-30T01:34:54.9385878Z     response = await authenticated_client.post(f"/api/v1/rooms/{test_room.id}/join")
2025-09-30T01:34:54.9386031Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9386454Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1859: in post
2025-09-30T01:34:54.9386584Z     return await self.request(
2025-09-30T01:34:54.9386984Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.9387285Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.9387432Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9387866Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.9388025Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.9388499Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.9388670Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.9389340Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.9389545Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.9389678Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9390199Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.9390564Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.9390782Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9391709Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.9391861Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9392291Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.9392451Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.9392900Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.9393055Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9393487Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.9393603Z     raise exc
2025-09-30T01:34:54.9394055Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.9394176Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.9394652Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.9394902Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.9395374Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9395474Z     raise exc
2025-09-30T01:34:54.9395964Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9396101Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9396576Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.9396767Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9397198Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.9397367Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.9397756Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.9397900Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9398326Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.9398585Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.9399117Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9399358Z     raise exc
2025-09-30T01:34:54.9399884Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9400036Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9400433Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.9400565Z     response = await f(request)
2025-09-30T01:34:54.9400687Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9401110Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.9401275Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.9402428Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.9402579Z     return await dependant.call(**values)
2025-09-30T01:34:54.9402692Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9402890Z app/api/v1/endpoints/room_router.py:149: in join_room
2025-09-30T01:34:54.9403279Z     join_response = await room_service.join_room(current_user, room_id)
2025-09-30T01:34:54.9403401Z                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9403714Z app/services/room_service.py:157: in join_room
2025-09-30T01:34:54.9403849Z     room = await self._get_room_or_404(room_id)
2025-09-30T01:34:54.9403954Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9404156Z app/services/room_service.py:360: in _get_room_or_404
2025-09-30T01:34:54.9404322Z     room = await self.room_repo.get_by_id(room_id)
2025-09-30T01:34:54.9404437Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9404637Z app/repositories/room_repository.py:58: in get_by_id
2025-09-30T01:34:54.9404761Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9404861Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9405392Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9405529Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9406077Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9406217Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9406320Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9406755Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9406892Z     return self._execute_internal(
2025-09-30T01:34:54.9407463Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.9407696Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.9408255Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.9408391Z     result = conn.execute(
2025-09-30T01:34:54.9408866Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.9408982Z     return meth(
2025-09-30T01:34:54.9409716Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.9409873Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.9410418Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.9410543Z     ret = self._execute_context(
2025-09-30T01:34:54.9411085Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.9411226Z     return self._exec_single_context(
2025-09-30T01:34:54.9411814Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.9411934Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.9412459Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9412597Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9413113Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.9413252Z     self.dialect.do_execute(
2025-09-30T01:34:54.9413694Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.9413826Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.9414304Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.9414427Z     self._adapt_connection.await_(
2025-09-30T01:34:54.9414963Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9415495Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9415676Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9416209Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9416310Z     value = await result
2025-09-30T01:34:54.9416410Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9417043Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.9417164Z     self._handle_exception(error)
2025-09-30T01:34:54.9417806Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.9417987Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.9418628Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9418738Z     raise error
2025-09-30T01:34:54.9419515Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.9419747Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.9420324Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.9420508Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.9420935Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.9421060Z     return await self._prepare(
2025-09-30T01:34:54.9421453Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.9421577Z     stmt = await self._get_statement(
2025-09-30T01:34:54.9422032Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.9422188Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.9422350Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.9422453Z     ???
2025-09-30T01:34:54.9425102Z E   RuntimeError: Task <Task pending name='Task-136' coro=<TestIntegrationAPI.test_join_room_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:118> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9425457Z ---------------------------- Captured stdout setup -----------------------------
2025-09-30T01:34:54.9425948Z ✅ Created integration test user with ID: 1
2025-09-30T01:34:54.9426295Z ✅ Created integration test room with ID: 1
2025-09-30T01:34:54.9426761Z ____________ TestIntegrationAPI.test_send_and_get_messages_workflow ____________
2025-09-30T01:34:54.9427574Z tests/e2e/test_integration_api.py:143: in test_send_and_get_messages_workflow
2025-09-30T01:34:54.9428127Z     join_response = await authenticated_client.post(f"/api/v1/rooms/{test_room.id}/join")
2025-09-30T01:34:54.9428352Z                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9429083Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1859: in post
2025-09-30T01:34:54.9429399Z     return await self.request(
2025-09-30T01:34:54.9430123Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.9430626Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.9430974Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9431644Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.9431987Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.9432776Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.9433050Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.9433893Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.9434175Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.9434362Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9435386Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.9435720Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.9436041Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9436950Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.9437128Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9438439Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.9438650Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.9439502Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.9439773Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9440548Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.9440701Z     raise exc
2025-09-30T01:34:54.9441503Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.9441747Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.9442588Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.9443019Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.9443843Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9444036Z     raise exc
2025-09-30T01:34:54.9444728Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9444898Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9445635Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.9445879Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9446507Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.9446733Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.9447366Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.9447573Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9448214Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.9448654Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.9449605Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9449807Z     raise exc
2025-09-30T01:34:54.9450698Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9451111Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9451818Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.9452074Z     response = await f(request)
2025-09-30T01:34:54.9452228Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9452925Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.9453168Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.9453987Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.9454212Z     return await dependant.call(**values)
2025-09-30T01:34:54.9454407Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9454688Z app/api/v1/endpoints/room_router.py:149: in join_room
2025-09-30T01:34:54.9455082Z     join_response = await room_service.join_room(current_user, room_id)
2025-09-30T01:34:54.9455273Z                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9455517Z app/services/room_service.py:157: in join_room
2025-09-30T01:34:54.9455784Z     room = await self._get_room_or_404(room_id)
2025-09-30T01:34:54.9456008Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9456379Z app/services/room_service.py:360: in _get_room_or_404
2025-09-30T01:34:54.9456670Z     room = await self.room_repo.get_by_id(room_id)
2025-09-30T01:34:54.9456841Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9457130Z app/repositories/room_repository.py:58: in get_by_id
2025-09-30T01:34:54.9457337Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9457514Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9458557Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9458759Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9459603Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9459789Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9459955Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9460521Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9460677Z     return self._execute_internal(
2025-09-30T01:34:54.9461378Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.9461675Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.9462325Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.9462525Z     result = conn.execute(
2025-09-30T01:34:54.9463119Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.9463247Z     return meth(
2025-09-30T01:34:54.9463995Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.9464187Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.9464904Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.9465083Z     ret = self._execute_context(
2025-09-30T01:34:54.9465784Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.9465963Z     return self._exec_single_context(
2025-09-30T01:34:54.9466676Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.9466836Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.9467566Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9467921Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9468678Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.9468850Z     self.dialect.do_execute(
2025-09-30T01:34:54.9469626Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.9469784Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.9470526Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.9470700Z     self._adapt_connection.await_(
2025-09-30T01:34:54.9471414Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9471912Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9472034Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9472782Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9472927Z     value = await result
2025-09-30T01:34:54.9473061Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9473859Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.9474010Z     self._handle_exception(error)
2025-09-30T01:34:54.9474846Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.9475064Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.9475901Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9476054Z     raise error
2025-09-30T01:34:54.9476905Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.9477193Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.9477996Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.9478234Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.9478770Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.9478919Z     return await self._prepare(
2025-09-30T01:34:54.9479655Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.9479814Z     stmt = await self._get_statement(
2025-09-30T01:34:54.9480412Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.9480619Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.9480828Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.9480947Z     ???
2025-09-30T01:34:54.9483665Z E   RuntimeError: Task <Task pending name='Task-146' coro=<TestIntegrationAPI.test_send_and_get_messages_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:143> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9483928Z ---------------------------- Captured stdout setup -----------------------------
2025-09-30T01:34:54.9484285Z ✅ Created integration test user with ID: 1
2025-09-30T01:34:54.9484561Z ✅ Created integration test room with ID: 1
2025-09-30T01:34:54.9485049Z _________________ TestIntegrationAPI.test_leave_room_workflow __________________
2025-09-30T01:34:54.9485395Z tests/e2e/test_integration_api.py:172: in test_leave_room_workflow
2025-09-30T01:34:54.9485956Z     join_response = await authenticated_client.post(f"/api/v1/rooms/{test_room.id}/join")
2025-09-30T01:34:54.9486139Z                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9486650Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1859: in post
2025-09-30T01:34:54.9486838Z     return await self.request(
2025-09-30T01:34:54.9487358Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1540: in request
2025-09-30T01:34:54.9487799Z     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-09-30T01:34:54.9487985Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9488546Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1629: in send
2025-09-30T01:34:54.9488737Z     response = await self._send_handling_auth(
2025-09-30T01:34:54.9489512Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1657: in _send_handling_auth
2025-09-30T01:34:54.9489725Z     response = await self._send_handling_redirects(
2025-09-30T01:34:54.9490489Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1694: in _send_handling_redirects
2025-09-30T01:34:54.9490754Z     response = await self._send_single_request(request)
2025-09-30T01:34:54.9490916Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9491521Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_client.py:1730: in _send_single_request
2025-09-30T01:34:54.9491854Z     response = await transport.handle_async_request(request)
2025-09-30T01:34:54.9492035Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9492742Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/httpx/_transports/asgi.py:170: in handle_async_request
2025-09-30T01:34:54.9492946Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9493658Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__
2025-09-30T01:34:54.9493867Z     await super().__call__(scope, receive, send)
2025-09-30T01:34:54.9494618Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/applications.py:112: in __call__
2025-09-30T01:34:54.9494873Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9495870Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__
2025-09-30T01:34:54.9496029Z     raise exc
2025-09-30T01:34:54.9496850Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__
2025-09-30T01:34:54.9497128Z     await self.app(scope, receive, _send)
2025-09-30T01:34:54.9498105Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__
2025-09-30T01:34:54.9498707Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-09-30T01:34:54.9499993Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9500214Z     raise exc
2025-09-30T01:34:54.9501368Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9501656Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9502640Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:714: in __call__
2025-09-30T01:34:54.9503005Z     await self.middleware_stack(scope, receive, send)
2025-09-30T01:34:54.9503937Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:734: in app
2025-09-30T01:34:54.9504407Z     await route.handle(scope, receive, send)
2025-09-30T01:34:54.9505475Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:288: in handle
2025-09-30T01:34:54.9505759Z     await self.app(scope, receive, send)
2025-09-30T01:34:54.9506671Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:76: in app
2025-09-30T01:34:54.9507251Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-09-30T01:34:54.9508399Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-09-30T01:34:54.9508613Z     raise exc
2025-09-30T01:34:54.9509884Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-09-30T01:34:54.9510159Z     await app(scope, receive, sender)
2025-09-30T01:34:54.9511076Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/starlette/routing.py:73: in app
2025-09-30T01:34:54.9511350Z     response = await f(request)
2025-09-30T01:34:54.9511574Z                ^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9512474Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:301: in app
2025-09-30T01:34:54.9512801Z     raw_response = await run_endpoint_function(
2025-09-30T01:34:54.9513923Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function
2025-09-30T01:34:54.9514207Z     return await dependant.call(**values)
2025-09-30T01:34:54.9514444Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9514828Z app/api/v1/endpoints/room_router.py:149: in join_room
2025-09-30T01:34:54.9515339Z     join_response = await room_service.join_room(current_user, room_id)
2025-09-30T01:34:54.9515599Z                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9515932Z app/services/room_service.py:157: in join_room
2025-09-30T01:34:54.9516230Z     room = await self._get_room_or_404(room_id)
2025-09-30T01:34:54.9516464Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9516859Z app/services/room_service.py:360: in _get_room_or_404
2025-09-30T01:34:54.9517186Z     room = await self.room_repo.get_by_id(room_id)
2025-09-30T01:34:54.9517425Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9517821Z app/repositories/room_repository.py:58: in get_by_id
2025-09-30T01:34:54.9518101Z     result = await self.db.execute(query)
2025-09-30T01:34:54.9518332Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9519585Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py:463: in execute
2025-09-30T01:34:54.9519855Z     result = await greenlet_spawn(
2025-09-30T01:34:54.9521091Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:201: in greenlet_spawn
2025-09-30T01:34:54.9521383Z     result = context.throw(*sys.exc_info())
2025-09-30T01:34:54.9521621Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9522675Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2365: in execute
2025-09-30T01:34:54.9522950Z     return self._execute_internal(
2025-09-30T01:34:54.9524126Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/session.py:2251: in _execute_internal
2025-09-30T01:34:54.9524597Z     result: Result[Any] = compile_state_cls.orm_execute_statement(
2025-09-30T01:34:54.9525816Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/orm/context.py:306: in orm_execute_statement
2025-09-30T01:34:54.9526062Z     result = conn.execute(
2025-09-30T01:34:54.9527100Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1415: in execute
2025-09-30T01:34:54.9527322Z     return meth(
2025-09-30T01:34:54.9528558Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/sql/elements.py:523: in _execute_on_connection
2025-09-30T01:34:54.9528945Z     return connection._execute_clauseelement(
2025-09-30T01:34:54.9530037Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1637: in _execute_clauseelement
2025-09-30T01:34:54.9530236Z     ret = self._execute_context(
2025-09-30T01:34:54.9531120Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1842: in _execute_context
2025-09-30T01:34:54.9531331Z     return self._exec_single_context(
2025-09-30T01:34:54.9532297Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1982: in _exec_single_context
2025-09-30T01:34:54.9532503Z     self._handle_dbapi_exception(
2025-09-30T01:34:54.9533488Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:2354: in _handle_dbapi_exception
2025-09-30T01:34:54.9533746Z     raise exc_info[1].with_traceback(exc_info[2])
2025-09-30T01:34:54.9534692Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/base.py:1963: in _exec_single_context
2025-09-30T01:34:54.9534887Z     self.dialect.do_execute(
2025-09-30T01:34:54.9535775Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/engine/default.py:943: in do_execute
2025-09-30T01:34:54.9536004Z     cursor.execute(statement, parameters)
2025-09-30T01:34:54.9536992Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:580: in execute
2025-09-30T01:34:54.9537207Z     self._adapt_connection.await_(
2025-09-30T01:34:54.9538153Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:132: in await_only
2025-09-30T01:34:54.9538823Z     return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
2025-09-30T01:34:54.9539013Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-09-30T01:34:54.9540153Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py:196: in greenlet_spawn
2025-09-30T01:34:54.9540348Z     value = await result
2025-09-30T01:34:54.9540549Z             ^^^^^^^^^^^^
2025-09-30T01:34:54.9541689Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:558: in _prepare_and_execute
2025-09-30T01:34:54.9541902Z     self._handle_exception(error)
2025-09-30T01:34:54.9543022Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:508: in _handle_exception
2025-09-30T01:34:54.9543299Z     self._adapt_connection._handle_exception(error)
2025-09-30T01:34:54.9544433Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:794: in _handle_exception
2025-09-30T01:34:54.9544621Z     raise error
2025-09-30T01:34:54.9545776Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:521: in _prepare_and_execute
2025-09-30T01:34:54.9546143Z     prepared_stmt, attributes = await adapt_connection._prepare(
2025-09-30T01:34:54.9547170Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py:768: in _prepare
2025-09-30T01:34:54.9547460Z     prepared_stmt = await self._connection.prepare(
2025-09-30T01:34:54.9548318Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:635: in prepare
2025-09-30T01:34:54.9548527Z     return await self._prepare(
2025-09-30T01:34:54.9549460Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:653: in _prepare
2025-09-30T01:34:54.9549689Z     stmt = await self._get_statement(
2025-09-30T01:34:54.9550549Z /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
2025-09-30T01:34:54.9550782Z     statement = await self._protocol.prepare(
2025-09-30T01:34:54.9551216Z asyncpg/protocol/protocol.pyx:165: in prepare
2025-09-30T01:34:54.9551381Z     ???
2025-09-30T01:34:54.9554461Z E   RuntimeError: Task <Task pending name='Task-156' coro=<TestIntegrationAPI.test_leave_room_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:172> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9554756Z ---------------------------- Captured stdout setup -----------------------------
2025-09-30T01:34:54.9555027Z ✅ Created integration test user with ID: 1
2025-09-30T01:34:54.9555230Z ✅ Created integration test room with ID: 1
2025-09-30T01:34:54.9555425Z =========================== short test summary info ============================
2025-09-30T01:34:54.9557992Z FAILED tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_complete_chat_workflow - RuntimeError: Task <Task pending name='Task-8' coro=<TestCriticalUserJourneys.test_complete_chat_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_critical_workflows.py:24> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9560736Z FAILED tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_room_closure_workflow - RuntimeError: Task <Task pending name='Task-20' coro=<TestCriticalUserJourneys.test_room_closure_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_critical_workflows.py:95> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9563259Z FAILED tests/e2e/test_critical_workflows.py::TestCriticalUserJourneys::test_authentication_security - RuntimeError: Task <Task pending name='Task-28' coro=<TestCriticalUserJourneys.test_authentication_security() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_critical_workflows.py:146> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9564696Z FAILED tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_message_xor_constraint - sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9564943Z (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9567373Z FAILED tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_foreign_key_constraints - RuntimeError: Task <Task pending name='Task-53' coro=<TestDatabaseConstraints.test_foreign_key_constraints() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_database_constraints.py:112> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9568865Z FAILED tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_conversation_participant_constraints - sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9569106Z (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9570907Z FAILED tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_nullable_constraints - sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot perform operation: another operation is in progress
2025-09-30T01:34:54.9571133Z (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9573455Z FAILED tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_database_indexes_exist - RuntimeError: Task <Task pending name='Task-87' coro=<TestDatabaseConstraints.test_database_indexes_exist() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_database_constraints.py:280> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9575830Z FAILED tests/e2e/test_integration_api.py::TestIntegrationAPI::test_room_count_endpoint - RuntimeError: Task <Task pending name='Task-106' coro=<TestIntegrationAPI.test_room_count_endpoint() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:83> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9578193Z FAILED tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_all_rooms_endpoint - RuntimeError: Task <Task pending name='Task-116' coro=<TestIntegrationAPI.test_get_all_rooms_endpoint() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:93> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9580693Z FAILED tests/e2e/test_integration_api.py::TestIntegrationAPI::test_get_room_by_id_endpoint - RuntimeError: Task <Task pending name='Task-126' coro=<TestIntegrationAPI.test_get_room_by_id_endpoint() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:106> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9582886Z FAILED tests/e2e/test_integration_api.py::TestIntegrationAPI::test_join_room_workflow - RuntimeError: Task <Task pending name='Task-136' coro=<TestIntegrationAPI.test_join_room_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:118> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9585303Z FAILED tests/e2e/test_integration_api.py::TestIntegrationAPI::test_send_and_get_messages_workflow - RuntimeError: Task <Task pending name='Task-146' coro=<TestIntegrationAPI.test_send_and_get_messages_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:143> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9587798Z FAILED tests/e2e/test_integration_api.py::TestIntegrationAPI::test_leave_room_workflow - RuntimeError: Task <Task pending name='Task-156' coro=<TestIntegrationAPI.test_leave_room_workflow() running at /home/runner/work/the_gathering_beta/the_gathering_beta/tests/e2e/test_integration_api.py:172> cb=[_run_until_complete_cb() at /opt/hostedtoolcache/Python/3.13.7/x64/lib/python3.13/asyncio/base_events.py:181, WorkerThread.stop()]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop
2025-09-30T01:34:54.9589532Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_message_xor_constraint - sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.9589779Z (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9591261Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_unique_constraints - sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.9591430Z DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.9592671Z [SQL: INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at]
2025-09-30T01:34:54.9593470Z [parameters: ('user@example.com', 'testuser', '$2b$12$NxIQ.GNX527tipxO9yDXTOHP./wSI2SkYaMJKcFvpA7yTaAiR2a.q', None, 'en', 'AVAILABLE', True, datetime.datetime(2025, 9, 30, 1, 34, 46, 451953), False, None)]
2025-09-30T01:34:54.9593697Z (Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-30T01:34:54.9595295Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_conversation_participant_constraints - sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:54.9595549Z (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:54.9596970Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_enum_validation - sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:54.9597147Z DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:54.9598479Z [SQL: INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at]
2025-09-30T01:34:54.9599499Z [parameters: ('user@example.com', 'testuser', '$2b$12$nT55XU0jHBuETVUIMEl9KuZe.usHUDo9WPAO.nM8u9ra1bNWNkujm', None, 'en', 'AVAILABLE', True, datetime.datetime(2025, 9, 30, 1, 34, 48, 688810), False, None)]
2025-09-30T01:34:55.0163372Z (Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-30T01:34:55.0166900Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_nullable_constraints - sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: cannot use Connection.transaction() in a manually started transaction
2025-09-30T01:34:55.0170576Z (Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-09-30T01:34:55.0173943Z ERROR tests/e2e/test_database_constraints.py::TestDatabaseConstraints::test_cascading_deletes - sqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:55.0177718Z DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:55.0191778Z [SQL: INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at]
2025-09-30T01:34:55.0194095Z [parameters: ('user@example.com', 'testuser', '$2b$12$BGFzZsF4tNm7.hmvv1w96.i.Rxf5vzFIXX5VL73oGmZBZvpwkaFWe', None, 'en', 'AVAILABLE', True, datetime.datetime(2025, 9, 30, 1, 34, 50, 617443), False, None)]
2025-09-30T01:34:55.0195283Z (Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-30T01:34:55.0195864Z ============== 14 failed, 1 passed, 1 warning, 6 errors in 13.50s ==============
2025-09-30T01:34:55.2110997Z ##[error]Process completed with exit code 1.
2025-09-30T01:34:55.2187193Z Post job cleanup.
2025-09-30T01:34:55.3083755Z [command]/usr/bin/git version
2025-09-30T01:34:55.3121311Z git version 2.51.0
2025-09-30T01:34:55.3163504Z Temporarily overriding HOME='/home/runner/work/_temp/28e5cc7c-ca2e-41c5-bf85-30ff3cc836df' before making global git config changes
2025-09-30T01:34:55.3165382Z Adding repository directory to the temporary git global config as a safe directory
2025-09-30T01:34:55.3171156Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/the_gathering_beta/the_gathering_beta
2025-09-30T01:34:55.3212206Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-09-30T01:34:55.3242748Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-09-30T01:34:55.3447331Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-09-30T01:34:55.3468650Z http.https://github.com/.extraheader
2025-09-30T01:34:55.3482340Z [command]/usr/bin/git config --local --unset-all http.https://github.com/.extraheader
2025-09-30T01:34:55.3511097Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-09-30T01:34:55.3766083Z Print service container logs: 57e23b4e62c440d7b6e8150f6ba298ae_postgres13_6562e3
2025-09-30T01:34:55.3770567Z ##[command]/usr/bin/docker logs --details cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:55.3896401Z  The files belonging to this database system will be owned by user "postgres".
2025-09-30T01:34:55.3897314Z  This user must also own the server process.
2025-09-30T01:34:55.3897710Z  
2025-09-30T01:34:55.3898122Z  The database cluster will be initialized with locale "en_US.utf8".
2025-09-30T01:34:55.3898782Z  The default database encoding has accordingly been set to "UTF8".
2025-09-30T01:34:55.3899584Z  The default text search configuration will be set to "english".
2025-09-30T01:34:55.3900063Z  
2025-09-30T01:34:55.3900312Z  Data page checksums are disabled.
2025-09-30T01:34:55.3900668Z  
2025-09-30T01:34:55.3901097Z  fixing permissions on existing directory /var/lib/postgresql/data ... ok
2025-09-30T01:34:55.3901691Z  creating subdirectories ... ok
2025-09-30T01:34:55.3902142Z  selecting dynamic shared memory implementation ... posix
2025-09-30T01:34:55.3902628Z  selecting default max_connections ... 100
2025-09-30T01:34:55.3903065Z  selecting default shared_buffers ... 128MB
2025-09-30T01:34:55.3903475Z  selecting default time zone ... Etc/UTC
2025-09-30T01:34:55.3903902Z  creating configuration files ... ok
2025-09-30T01:34:55.3904333Z  running bootstrap script ... ok
2025-09-30T01:34:55.3904769Z  performing post-bootstrap initialization ... ok
2025-09-30T01:34:55.3908263Z  initdb: warning: enabling "trust" authentication for local connections
2025-09-30T01:34:55.3909428Z  You can change this by editing pg_hba.conf or using the option -A, or
2025-09-30T01:34:55.3910072Z  --auth-local and --auth-host, the next time you run initdb.
2025-09-30T01:34:55.3911056Z  2025-09-30 01:34:03.906 UTC [1] LOG:  starting PostgreSQL 13.22 (Debian 13.22-1.pgdg13+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 14.2.0-19) 14.2.0, 64-bit
2025-09-30T01:34:55.3912070Z  2025-09-30 01:34:03.906 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
2025-09-30T01:34:55.3912730Z  2025-09-30 01:34:03.906 UTC [1] LOG:  listening on IPv6 address "::", port 5432
2025-09-30T01:34:55.3913458Z  2025-09-30 01:34:03.907 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2025-09-30T01:34:55.3914259Z  2025-09-30 01:34:03.908 UTC [59] LOG:  database system was shut down at 2025-09-30 01:34:03 UTC
2025-09-30T01:34:55.3914987Z  2025-09-30 01:34:03.911 UTC [1] LOG:  database system is ready to accept connections
2025-09-30T01:34:55.3915615Z  2025-09-30 01:34:13.155 UTC [73] FATAL:  role "root" does not exist
2025-09-30T01:34:55.3916192Z  2025-09-30 01:34:23.240 UTC [80] FATAL:  role "root" does not exist
2025-09-30T01:34:55.3916746Z  2025-09-30 01:34:33.319 UTC [88] FATAL:  role "root" does not exist
2025-09-30T01:34:55.3917295Z  2025-09-30 01:34:43.390 UTC [97] FATAL:  role "root" does not exist
2025-09-30T01:34:55.3918030Z  2025-09-30 01:34:46.460 UTC [99] ERROR:  duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:55.3918821Z  2025-09-30 01:34:46.460 UTC [99] DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:55.3920933Z  2025-09-30 01:34:46.460 UTC [99] STATEMENT:  INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at
2025-09-30T01:34:55.3923427Z  2025-09-30 01:34:48.697 UTC [100] ERROR:  duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:55.3924307Z  2025-09-30 01:34:48.697 UTC [100] DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:55.3926620Z  2025-09-30 01:34:48.697 UTC [100] STATEMENT:  INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at
2025-09-30T01:34:55.3928840Z  2025-09-30 01:34:49.720 UTC [100] ERROR:  null value in column "email" of relation "users" violates not-null constraint
2025-09-30T01:34:55.3931078Z  2025-09-30 01:34:49.720 UTC [100] DETAIL:  Failing row contains (2, null, testuser, $2b$12$vqk30WxgUiW48mxTwyhTQux9f83GwkN.xzo3BkeWoplQf4emvUDHK, null, en, AVAILABLE, t, 2025-09-30 01:34:49.463713+00, 2025-09-30 01:34:49.718755+00, f, null).
2025-09-30T01:34:55.3933920Z  2025-09-30 01:34:49.720 UTC [100] STATEMENT:  INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at
2025-09-30T01:34:55.3935384Z  2025-09-30 01:34:50.625 UTC [101] ERROR:  duplicate key value violates unique constraint "ix_users_username"
2025-09-30T01:34:55.3935817Z  2025-09-30 01:34:50.625 UTC [101] DETAIL:  Key (username)=(testuser) already exists.
2025-09-30T01:34:55.3936875Z  2025-09-30 01:34:50.625 UTC [101] STATEMENT:  INSERT INTO users (email, username, password_hash, avatar_url, preferred_language, status, is_active, last_active, is_admin, current_room_id) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::userstatus, $7::BOOLEAN, $8::TIMESTAMP WITH TIME ZONE, $9::BOOLEAN, $10::INTEGER) RETURNING users.id, users.created_at
2025-09-30T01:34:55.3938042Z  2025-09-30 01:34:53.472 UTC [109] FATAL:  role "root" does not exist
2025-09-30T01:34:55.3938432Z  2025-09-30 01:34:54.871 UTC [101] LOG:  unexpected EOF on client connection with an open transaction
2025-09-30T01:34:55.3938887Z  2025-09-30 01:34:55.148 UTC [89] LOG:  unexpected EOF on client connection with an open transaction
2025-09-30T01:34:55.3939471Z  syncing data to disk ... ok
2025-09-30T01:34:55.3939714Z  
2025-09-30T01:34:55.3939862Z  
2025-09-30T01:34:55.3940054Z  Success. You can now start the database server using:
2025-09-30T01:34:55.3940306Z  
2025-09-30T01:34:55.3940508Z      pg_ctl -D /var/lib/postgresql/data -l logfile start
2025-09-30T01:34:55.3940748Z  
2025-09-30T01:34:55.3941238Z  waiting for server to start....2025-09-30 01:34:03.674 UTC [46] LOG:  starting PostgreSQL 13.22 (Debian 13.22-1.pgdg13+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 14.2.0-19) 14.2.0, 64-bit
2025-09-30T01:34:55.3941916Z  2025-09-30 01:34:03.675 UTC [46] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2025-09-30T01:34:55.3942346Z  2025-09-30 01:34:03.676 UTC [47] LOG:  database system was shut down at 2025-09-30 01:34:03 UTC
2025-09-30T01:34:55.3942750Z  2025-09-30 01:34:03.679 UTC [46] LOG:  database system is ready to accept connections
2025-09-30T01:34:55.3943048Z   done
2025-09-30T01:34:55.3943195Z  server started
2025-09-30T01:34:55.3943360Z  
2025-09-30T01:34:55.3943638Z  /usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*
2025-09-30T01:34:55.3943960Z  
2025-09-30T01:34:55.3944171Z  2025-09-30 01:34:03.791 UTC [46] LOG:  received fast shutdown request
2025-09-30T01:34:55.3944582Z  waiting for server to shut down....2025-09-30 01:34:03.792 UTC [46] LOG:  aborting any active transactions
2025-09-30T01:34:55.3945116Z  2025-09-30 01:34:03.793 UTC [46] LOG:  background worker "logical replication launcher" (PID 53) exited with exit code 1
2025-09-30T01:34:55.3945534Z  2025-09-30 01:34:03.794 UTC [48] LOG:  shutting down
2025-09-30T01:34:55.3945826Z  2025-09-30 01:34:03.800 UTC [46] LOG:  database system is shut down
2025-09-30T01:34:55.3946080Z   done
2025-09-30T01:34:55.3946227Z  server stopped
2025-09-30T01:34:55.3946385Z  
2025-09-30T01:34:55.3946580Z  PostgreSQL init process complete; ready for start up.
2025-09-30T01:34:55.3946940Z  
2025-09-30T01:34:55.3952214Z Stop and remove container: 57e23b4e62c440d7b6e8150f6ba298ae_postgres13_6562e3
2025-09-30T01:34:55.3956548Z ##[command]/usr/bin/docker rm --force cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:55.5152209Z cbd7b6fdbd7ee8f31b3105d35235defdb7b339c8c06a3180502d7e7482bf32d3
2025-09-30T01:34:55.5174330Z Remove container network: github_network_129d360d8a194ec6b3121a11e42977ca
2025-09-30T01:34:55.5178544Z ##[command]/usr/bin/docker network rm github_network_129d360d8a194ec6b3121a11e42977ca
2025-09-30T01:34:55.5906837Z github_network_129d360d8a194ec6b3121a11e42977ca
2025-09-30T01:34:55.5969425Z Cleaning up orphan processes
